python my HMM
['sparkpybkt_hdfs_beta3.py', '1', '8']
BaumWelch
user_num  10000
column_num 20
beta3
num iteration  0
[[ 0.89946241  0.10053759]
 [ 0.1895838   0.8104162 ]]
[[ 0.23716273  0.76283727]
 [ 0.41706131  0.58293869]]
Pi: [ 0.41281452  0.58718548]
-126642.415708
num iteration  0
[[ 0.92235681  0.07764319]
 [ 0.1842682   0.8157318 ]]
[[ 0.15297496  0.84702504]
 [ 0.55590128  0.44409872]]
Pi: [ 0.27100354  0.72899646]
-117315.620921
rate: 9.32679478648e+72 0.001
delta: 9326.79478648 0.001
small change times: 0
num iteration  1
[[ 0.95786824  0.04213176]
 [ 0.17466085  0.82533915]]
[[ 0.09281557  0.90718443]
 [ 0.70557212  0.29442788]]
Pi: [ 0.14400473  0.85599527]
-103641.937321
rate: 1.46606459271 0.001
delta: 13673.6835999 0.001
small change times: 0
num iteration  2
[[ 0.97773158  0.02226842]
 [ 0.17004619  0.82995381]]
[[ 0.07960023  0.92039977]
 [ 0.79260627  0.20739373]]
Pi: [ 0.10074786  0.89925214]
-92635.5541129
rate: 0.804931833345 0.001
delta: 11006.3832086 0.001
small change times: 0
num iteration  3
[[ 0.98666726  0.01333274]
 [ 0.16780762  0.83219238]]
[[ 0.08343343  0.91656657]
 [ 0.83002449  0.16997551]]
Pi: [ 0.09718097  0.90281903]
-89449.5091372
rate: 0.289472473857 0.001
delta: 3186.04497562 0.001
small change times: 0
num iteration  4
[[ 0.99157231  0.00842769]
 [ 0.164958    0.835042  ]]
[[ 0.08908675  0.91091325]
 [ 0.84626741  0.15373259]]
Pi: [ 0.10436027  0.89563973]
-88562.1211611
rate: 0.278523367649 0.001
delta: 887.387976092 0.001
small change times: 0
num iteration  5
[[ 0.99452188  0.00547812]
 [ 0.16200604  0.83799396]]
[[ 0.09318294  0.90681706]
 [ 0.85359765  0.14640235]]
Pi: [ 0.11230474  0.88769526]
-88183.0146198
rate: 0.427216225054 0.001
delta: 379.106541305 0.001
small change times: 0
num iteration  6
[[ 0.99634282  0.00365718]
 [ 0.15959017  0.84040983]]
[[ 0.09577298  0.90422702]
 [ 0.85684268  0.14315732]]
Pi: [ 0.11817861  0.88182139]
-87996.3430063
rate: 0.492398819725 0.001
delta: 186.671613489 0.001
small change times: 0
num iteration  7
[[ 0.99749037  0.00250963]
 [ 0.15783097  0.84216903]]
[[ 0.09736915  0.90263085]
 [ 0.85817325  0.14182675]]
Pi: [ 0.12187846  0.87812154]
-87898.9792113
rate: 0.521577936925 0.001
delta: 97.3637950459 0.001
small change times: 0
num iteration  8
[[ 0.99823088  0.00176912]
 [ 0.15661069  0.84338931]]
[[ 0.09836209  0.90163791]
 [ 0.8586296   0.1413704 ]]
Pi: [ 0.12402977  0.87597023]
-87845.3769649
rate: 0.550535713556 0.001
delta: 53.60224638 0.001
small change times: 0
num iteration  9
[[ 0.99872086  0.00127914]
 [ 0.15577543  0.84422457]]
[[ 0.09899429  0.90100571]
 [ 0.85870746  0.14129254]]
Pi: [ 0.12523125  0.87476875]
-87814.3319589
rate: 0.57917360019 0.001
delta: 31.0450060142 0.001
small change times: 0
num iteration  10
[[  9.99053241e-01   9.46758702e-04]
 [  1.55200984e-01   8.44799016e-01]]
[[ 0.0994087   0.9005913 ]
 [ 0.85863607  0.14136393]]
Pi: [ 0.12589057  0.87410943]
-87795.558747
rate: 0.604709557683 0.001
delta: 18.7732118551 0.001
small change times: 0
num iteration  11
[[  9.99284133e-01   7.15866556e-04]
 [  1.54800433e-01   8.45199567e-01]]
[[ 0.09968879  0.90031121]
 [ 0.85851732  0.14148268]]
Pi: [ 0.12625118  0.87374882]
-87783.791793
rate: 0.626794933648 0.001
delta: 11.7669540791 0.001
small change times: 0
num iteration  12
[[  9.99448121e-01   5.51878634e-04]
 [  1.54516179e-01   8.45483821e-01]]
[[ 0.09988375  0.90011625]
 [ 0.85839404  0.14160596]]
Pi: [ 0.12644968  0.87355032]
-87776.1884359
rate: 0.646161873051 0.001
delta: 7.60335708785 0.001
small change times: 0
num iteration  13
[[  9.99566985e-01   4.33015243e-04]
 [  1.54310700e-01   8.45689300e-01]]
[[ 0.10002317  0.89997683]
 [ 0.85828244  0.14171756]]
Pi: [ 0.12656039  0.87343961]
-87771.1439489
rate: 0.663455223542 0.001
delta: 5.04448697639 0.001
small change times: 0
num iteration  14
[[  9.99654744e-01   3.45255846e-04]
 [  1.54159517e-01   8.45840483e-01]]
[[ 0.10012529  0.89987471]
 [ 0.85818714  0.14181286]]
Pi: [ 0.12662327  0.87337673]
-87767.7187545
rate: 0.678997573756 0.001
delta: 3.42519441781 0.001
small change times: 0
num iteration  15
[[  9.99720624e-01   2.79376363e-04]
 [  1.54046471e-01   8.45953529e-01]]
[[ 0.10020169  0.89979831]
 [ 0.85810801  0.14189199]]
Pi: [ 0.12665976  0.87334024]
-87765.3453761
rate: 0.692917849491 0.001
delta: 2.37337835008 0.001
small change times: 0
num iteration  16
[[  9.99770821e-01   2.29178670e-04]
 [  1.53960711e-01   8.46039289e-01]]
[[ 0.10025992  0.89974008]
 [ 0.8580432   0.1419568 ]]
Pi: [ 0.12668145  0.87331855]
-87763.6714472
rate: 0.705293778636 0.001
delta: 1.67392898466 0.001
small change times: 0
num iteration  17
[[  9.99809587e-01   1.90413148e-04]
 [  1.53894812e-01   8.46105188e-01]]
[[ 0.10030502  0.89969498]
 [ 0.85799043  0.14200957]]
Pi: [ 0.12669469  0.87330531]
-87762.4725363
rate: 0.716225629976 0.001
delta: 1.19891084157 0.001
small change times: 0
num iteration  18
[[  9.99839889e-01   1.60110535e-04]
 [  1.53843593e-01   8.46156407e-01]]
[[ 0.10034047  0.89965953]
 [ 0.85794754  0.14205246]]
Pi: [ 0.12670299  0.87329701]
-87761.6022999
rate: 0.725855816682 0.001
delta: 0.870236408038 0.001
small change times: 0
num iteration  19
[[  9.99863840e-01   1.36159622e-04]
 [  1.53803372e-01   8.46196628e-01]]
[[ 0.1003687   0.8996313 ]
 [ 0.85791263  0.14208737]]
Pi: [ 0.12670834  0.87329166]
-87760.9632318
rate: 0.734361468127 0.001
delta: 0.639068086224 0.001
small change times: 0
num iteration  20
[[  9.99882965e-01   1.17035173e-04]
 [  1.53771491e-01   8.46228509e-01]]
[[ 0.10039145  0.89960855]
 [ 0.85788415  0.14211585]]
Pi: [ 0.1267119  0.8732881]
-87760.4890832
rate: 0.741937628594 0.001
delta: 0.474148660403 0.001
small change times: 0
num iteration  21
[[  9.99898381e-01   1.01619285e-04]
 [  1.53746000e-01   8.46254000e-01]]
[[ 0.10040997  0.89959003]
 [ 0.85786082  0.14213918]]
Pi: [ 0.12671433  0.87328567]
-87760.1340503
rate: 0.748779617069 0.001
delta: 0.355032852371 0.001
small change times: 0
num iteration  22
[[  9.99910918e-01   8.90819415e-05]
 [  1.53725454e-01   8.46274546e-01]]
[[ 0.10042521  0.89957479]
 [ 0.85784162  0.14215838]]
Pi: [ 0.12671604  0.87328396]
-87759.8659763
rate: 0.755068131278 0.001
delta: 0.268073992382 0.001
small change times: 0
num iteration  23
[[  9.99921200e-01   7.87996911e-05]
 [  1.53708763e-01   8.46291237e-01]]
[[ 0.10043786  0.89956214]
 [ 0.85782574  0.14217426]]
Pi: [ 0.12671728  0.87328272]
-87759.6619831
rate: 0.760958548826 0.001
delta: 0.203993196221 0.001
small change times: 0
num iteration  24
[[  9.99929701e-01   7.02993605e-05]
 [  1.53695105e-01   8.46304895e-01]]
[[ 0.10044845  0.89955155]
 [ 0.85781254  0.14218746]]
Pi: [ 0.1267182  0.8732818]
-87759.505607
rate: 0.766574916073 0.001
delta: 0.156376067273 0.001
small change times: 0
num iteration  25
[[  9.99936782e-01   6.32184570e-05]
 [  1.53683848e-01   8.46316152e-01]]
[[ 0.10045738  0.89954262]
 [ 0.8578015   0.1421985 ]]
Pi: [ 0.1267189  0.8732811]
-87759.3848834
rate: 0.772008374669 0.001
delta: 0.120723633532 0.001
small change times: 0
num iteration  26
[[  9.99942723e-01   5.72769067e-05]
 [  1.53674504e-01   8.46325496e-01]]
[[ 0.10046498  0.89953502]
 [ 0.85779221  0.14220779]]
Pi: [ 0.12671946  0.87328054]
-87759.2910426
rate: 0.777319244186 0.001
delta: 0.0938408035727 0.001
small change times: 0
num iteration  27
[[  9.99947743e-01   5.22566108e-05]
 [  1.53666697e-01   8.46333303e-01]]
[[ 0.10047148  0.89952852]
 [ 0.85778436  0.14221564]]
Pi: [ 0.1267199  0.8732801]
-87759.2176083
rate: 0.782541540472 0.001
delta: 0.0734343269869 0.001
small change times: 0
num iteration  28
[[  9.99952014e-01   4.79864821e-05]
 [  1.53660131e-01   8.46339869e-01]]
[[ 0.10047708  0.89952292]
 [ 0.85777768  0.14222232]]
Pi: [ 0.12672027  0.87327973]
-87759.1597649
rate: 0.787688762782 0.001
delta: 0.05784339417 0.001
small change times: 0
num iteration  29
[[  9.99955669e-01   4.43313755e-05]
 [  1.53654572e-01   8.46345428e-01]]
[[ 0.10048194  0.89951806]
 [ 0.85777196  0.14222804]]
Pi: [ 0.12672057  0.87327943]
-87759.113909
rate: 0.792759810999 0.001
delta: 0.0458559182298 0.001
small change times: 0
num iteration  30
[[  9.99958816e-01   4.11838245e-05]
 [  1.53649838e-01   8.46350162e-01]]
[[ 0.10048617  0.89951383]
 [ 0.85776704  0.14223296]]
Pi: [ 0.12672082  0.87327918]
-87759.0773277
rate: 0.797744353979 0.001
delta: 0.0365812998643 0.001
small change times: 0
num iteration  31
[[  9.99961542e-01   3.84578213e-05]
 [  1.53645781e-01   8.46354219e-01]]
[[ 0.10048988  0.89951012]
 [ 0.85776279  0.14223721]]
Pi: [ 0.12672104  0.87327896]
-87759.0479665
rate: 0.802627200437 0.001
delta: 0.0293611462985 0.001
small change times: 0
num iteration  32
[[  9.99963916e-01   3.60841006e-05]
 [  1.53642286e-01   8.46357714e-01]]
[[ 0.10049314  0.89950686]
 [ 0.85775909  0.14224091]]
Pi: [ 0.12672123  0.87327877]
-87759.0242606
rate: 0.807391611013 0.001
delta: 0.0237059432111 0.001
small change times: 0
num iteration  33
[[  9.99965993e-01   3.40065398e-05]
 [  1.53639257e-01   8.46360743e-01]]
[[ 0.10049602  0.89950398]
 [ 0.85775586  0.14224414]]
Pi: [ 0.1267214  0.8732786]
-87759.0050108
rate: 0.812021489966 0.001
delta: 0.0192497353273 0.001
small change times: 0
num iteration  34
[[  9.99967821e-01   3.21793940e-05]
 [  1.53636620e-01   8.46363380e-01]]
[[ 0.10049859  0.89950141]
 [ 0.85775302  0.14224698]]
Pi: [ 0.12672154  0.87327846]
-87758.9892934
rate: 0.816502791063 0.001
delta: 0.015717462622 0.001
small change times: 0
num iteration  35
[[  9.99969435e-01   3.05651605e-05]
 [  1.53634311e-01   8.46365689e-01]]
[[ 0.10050087  0.89949913]
 [ 0.85775052  0.14224948]]
Pi: [ 0.12672167  0.87327833]
-87758.9763921
rate: 0.820824273416 0.001
delta: 0.0129012748366 0.001
small change times: 0
num iteration  36
[[  9.99970867e-01   2.91329195e-05]
 [  1.53632281e-01   8.46367719e-01]]
[[ 0.10050292  0.89949708]
 [ 0.85774831  0.14225169]]
Pi: [ 0.12672179  0.87327821]
-87758.9657488
rate: 0.824977607831 0.001
delta: 0.0106432628527 0.001
small change times: 0
num iteration  37
[[  9.99972143e-01   2.78570375e-05]
 [  1.53630487e-01   8.46369513e-01]]
[[ 0.10050475  0.89949525]
 [ 0.85774634  0.14225366]]
Pi: [ 0.12672189  0.87327811]
-87758.956926
rate: 0.828957468705 0.001
delta: 0.00882281223312 0.001
small change times: 0
num iteration  38
[[  9.99973284e-01   2.67161500e-05]
 [  1.53628897e-01   8.46371103e-01]]
[[ 0.10050641  0.89949359]
 [ 0.85774458  0.14225542]]
Pi: [ 0.12672198  0.87327802]
-87758.9495787
rate: 0.832761168482 0.001
delta: 0.00734729542455 0.001
small change times: 0
num iteration  39
[[  9.99974308e-01   2.56923575e-05]
 [  1.53627480e-01   8.46372520e-01]]
[[ 0.1005079   0.8994921 ]
 [ 0.85774301  0.14225699]]
Pi: [ 0.12672207  0.87327793]
-87758.9434335
rate: 0.836388270581 0.001
delta: 0.00614519171359 0.001
small change times: 0
num iteration  40
[[  9.99975229e-01   2.47705884e-05]
 [  1.53626214e-01   8.46373786e-01]]
[[ 0.10050926  0.89949074]
 [ 0.85774159  0.14225841]]
Pi: [ 0.12672214  0.87327786]
-87758.9382726
rate: 0.839840401467 0.001
delta: 0.00516098027583 0.001
small change times: 0
num iteration  41
[[  9.99976062e-01   2.39380899e-05]
 [  1.53625078e-01   8.46374922e-01]]
[[ 0.10051049  0.89948951]
 [ 0.85774031  0.14225969]]
Pi: [ 0.12672221  0.87327779]
-87758.9339212
rate: 0.843120596245 0.001
delta: 0.00435132876737 0.001
small change times: 0
num iteration  42
[[  9.99976816e-01   2.31840208e-05]
 [  1.53624056e-01   8.46375944e-01]]
[[ 0.10051161  0.89948839]
 [ 0.85773916  0.14226084]]
Pi: [ 0.12672227  0.87327773]
-87758.930239
rate: 0.846233179394 0.001
delta: 0.0036822387774 0.001
small change times: 0
num iteration  43
[[  9.99977501e-01   2.24991232e-05]
 [  1.53623133e-01   8.46376867e-01]]
[[ 0.10051263  0.89948737]
 [ 0.85773811  0.14226189]]
Pi: [ 0.12672233  0.87327767]
-87758.9271121
rate: 0.849183463258 0.001
delta: 0.00312689627754 0.001
small change times: 0
num iteration  44
[[  9.99978125e-01   2.18754564e-05]
 [  1.53622298e-01   8.46377702e-01]]
[[ 0.10051357  0.89948643]
 [ 0.85773716  0.14226284]]
Pi: [ 0.12672238  0.87327762]
-87758.9244481
rate: 0.851977192004 0.001
delta: 0.00266404431022 0.001
small change times: 0
num iteration  45
[[  9.99978694e-01   2.13061811e-05]
 [  1.53621539e-01   8.46378461e-01]]
[[ 0.10051443  0.89948557]
 [ 0.85773629  0.14226371]]
Pi: [ 0.12672243  0.87327757]
-87758.9221713
rate: 0.854620662324 0.001
delta: 0.00227674731286 0.001
small change times: 0
num iteration  46
[[  9.99979215e-01   2.07853826e-05]
 [  1.53620849e-01   8.46379151e-01]]
[[ 0.10051522  0.89948478]
 [ 0.8577355   0.1422645 ]]
Pi: [ 0.12672247  0.87327753]
-87758.9202199
rate: 0.857120662073 0.001
delta: 0.00195144716417 0.001
small change times: 0
num iteration  47
[[  9.99979692e-01   2.03079262e-05]
 [  1.53620219e-01   8.46379781e-01]]
[[ 0.10051594  0.89948406]
 [ 0.85773477  0.14226523]]
Pi: [ 0.12672251  0.87327749]
-87758.9185426
rate: 0.85948346886 0.001
delta: 0.00167723657796 0.001
small change times: 0
num iteration  48
[[  9.99980131e-01   1.98693372e-05]
 [  1.53619643e-01   8.46380357e-01]]
[[ 0.10051661  0.89948339]
 [ 0.8577341   0.1422659 ]]
Pi: [ 0.12672255  0.87327745]
-87758.9170973
rate: 0.86171636149 0.001
delta: 0.00144530220132 0.001
small change times: 0
num iteration  49
[[  9.99980534e-01   1.94657024e-05]
 [  1.53619115e-01   8.46380885e-01]]
[[ 0.10051723  0.89948277]
 [ 0.85773349  0.14226651]]
Pi: [ 0.12672259  0.87327741]
-87758.9158488
rate: 0.863825019814 0.001
delta: 0.00124848820269 0.001
small change times: 0
num iteration  50
[[  9.99980906e-01   1.90935880e-05]
 [  1.53618630e-01   8.46381370e-01]]
[[ 0.1005178   0.8994822 ]
 [ 0.85773293  0.14226707]]
Pi: [ 0.12672262  0.87327738]
-87758.9147679
rate: 0.865817019493 0.001
delta: 0.00108096233453 0.001
small change times: 0
num iteration  51
[[  9.99981250e-01   1.87499704e-05]
 [  1.53618184e-01   8.46381816e-01]]
[[ 0.10051833  0.89948167]
 [ 0.8577324   0.1422676 ]]
Pi: [ 0.12672265  0.87327735]
-87758.9138299
rate: 0.867697548056 0.001
delta: 0.000937948367209 0.001
small change times: 1
num iteration  52
[[  9.99981568e-01   1.84321789e-05]
 [  1.53617773e-01   8.46382227e-01]]
[[ 0.10051883  0.89948117]
 [ 0.85773192  0.14226808]]
Pi: [ 0.12672267  0.87327733]
-87758.9130144
rate: 0.869473569141 0.001
delta: 0.000815521314507 0.001
small change times: 2
num iteration  53
[[  9.99981862e-01   1.81378478e-05]
 [  1.53617394e-01   8.46382606e-01]]
[[ 0.10051928  0.89948072]
 [ 0.85773148  0.14226852]]
Pi: [ 0.1267227  0.8732773]
-87758.912304
rate: 0.871150039476 0.001
delta: 0.000710441425326 0.001
small change times: 3
num iteration  54
[[  9.99982135e-01   1.78648747e-05]
 [  1.53617043e-01   8.46382957e-01]]
[[ 0.10051971  0.89948029]
 [ 0.85773106  0.14226894]]
Pi: [ 0.12672272  0.87327728]
-87758.9116839
rate: 0.87273351108 0.001
delta: 0.000620026039542 0.001
small change times: 4
num iteration  55
[[  9.99982389e-01   1.76113864e-05]
 [  1.53616719e-01   8.46383281e-01]]
[[ 0.1005201   0.8994799 ]
 [ 0.85773068  0.14226932]]
Pi: [ 0.12672274  0.87327726]
-87758.9111419
rate: 0.874227821554 0.001
delta: 0.000542044013855 0.001
small change times: 5
num iteration  56
[[  9.99982624e-01   1.73757092e-05]
 [  1.53616418e-01   8.46383582e-01]]
[[ 0.10052047  0.89947953]
 [ 0.85773032  0.14226968]]
Pi: [ 0.12672276  0.87327724]
-87758.9106673
rate: 0.87563979267 0.001
delta: 0.00047463530791 0.001
small change times: 6
==================================================
只有EM步骤迭代
HMM content: N = 2 ,M = 2
hmm.A  [  9.99982624e-01   1.73757092e-05]  hmm.B  [ 0.10052047  0.89947953]
       [ 0.15361642  0.84638358]         [ 0.85773032  0.14226968]
hmm.pi [ 0.12672276  0.87327724]
finalprob: -87758.9106673
iteration num: 57
totaltime: 57
==================================================
