python my HMM
['sparkpybkt_hdfs_beta3.py', '4', '5']
BaumWelch
user_num  10000
column_num 20
beta3
num iteration  0
[[ 0.61671854  0.38328146]
 [ 0.1691129   0.8308871 ]]
[[ 0.55287095  0.44712905]
 [ 0.18165507  0.81834493]]
Pi: [ 0.64910343  0.35089657]
-119670.614033
num iteration  0
[[ 0.67274506  0.32725494]
 [ 0.12786137  0.87213863]]
[[ 0.66037289  0.33962711]
 [ 0.12328829  0.87671171]]
Pi: [ 0.81058884  0.18941116]
-112907.765634
rate: 6.76284839885e+72 0.001
delta: 6762.84839885 0.001
small change times: 0
num iteration  1
[[ 0.7371492   0.2628508 ]
 [ 0.07937095  0.92062905]]
[[ 0.75799188  0.24200812]
 [ 0.08039086  0.91960914]]
Pi: [ 0.89766382  0.10233618]
-102437.974948
rate: 1.54813328176 0.001
delta: 10469.7906857 0.001
small change times: 0
num iteration  2
[[ 0.77894795  0.22105205]
 [ 0.04741553  0.95258447]]
[[ 0.81416767  0.18583233]
 [ 0.06785106  0.93214894]]
Pi: [ 0.92039805  0.07960195]
-93976.1915871
rate: 0.808209410802 0.001
delta: 8461.78336134 0.001
small change times: 0
num iteration  3
[[ 0.80127921  0.19872079]
 [ 0.03019739  0.96980261]]
[[ 0.83806418  0.16193582]
 [ 0.0719586   0.9280414 ]]
Pi: [ 0.91680788  0.08319212]
-90840.0153069
rate: 0.370628287944 0.001
delta: 3136.17628017 0.001
small change times: 0
num iteration  4
[[ 0.81564501  0.18435499]
 [ 0.01953748  0.98046252]]
[[ 0.8490087   0.1509913 ]
 [ 0.07979418  0.92020582]]
Pi: [ 0.90606077  0.09393923]
-89619.711936
rate: 0.389105478097 0.001
delta: 1220.30337089 0.001
small change times: 0
num iteration  5
[[ 0.82577493  0.17422507]
 [ 0.01256403  0.98743597]]
[[ 0.85470759  0.14529241]
 [ 0.08652003  0.91347997]]
Pi: [ 0.89547395  0.10452605]
-88867.6896018
rate: 0.616258507678 0.001
delta: 752.02233426 0.001
small change times: 0
num iteration  6
[[ 0.83273175  0.16726825]
 [ 0.00809942  0.99190058]]
[[ 0.85760699  0.14239301]
 [ 0.09128006  0.90871994]]
Pi: [ 0.88731752  0.11268248]
-88400.7594453
rate: 0.620899320717 0.001
delta: 466.930156506 0.001
small change times: 0
num iteration  7
[[ 0.83731982  0.16268018]
 [ 0.00530169  0.99469831]]
[[ 0.85888886  0.14111114]
 [ 0.09440847  0.90559153]]
Pi: [ 0.88176782  0.11823218]
-88129.690818
rate: 0.580533562627 0.001
delta: 271.068627254 0.001
small change times: 0
num iteration  8
[[ 0.84028341  0.15971659]
 [ 0.00355238  0.99644762]]
[[ 0.85930348  0.14069652]
 [ 0.09641353  0.90358647]]
Pi: [ 0.87827309  0.12172691]
-87977.2679267
rate: 0.562303697171 0.001
delta: 152.422891292 0.001
small change times: 0
num iteration  9
[[ 0.84219545  0.15780455]
 [ 0.00244395  0.99755605]]
[[ 0.8593068   0.1406932 ]
 [ 0.09769829  0.90230171]]
Pi: [ 0.87617815  0.12382185]
-87891.3632592
rate: 0.563594266022 0.001
delta: 85.9046675427 0.001
small change times: 0
num iteration  10
[[ 0.84344311  0.15655689]
 [ 0.00172645  0.99827355]]
[[ 0.85914523  0.14085477]
 [ 0.09853213  0.90146787]]
Pi: [ 0.87495795  0.12504205]
-87841.8632963
rate: 0.576219713298 0.001
delta: 49.4999629025 0.001
small change times: 0
num iteration  11
[[ 0.8442721   0.1557279 ]
 [ 0.00125059  0.99874941]]
[[ 0.85893783  0.14106217]
 [ 0.09908407  0.90091593]]
Pi: [ 0.87425685  0.12574315]
-87812.4745904
rate: 0.593711674849 0.001
delta: 29.3887058798 0.001
small change times: 0
num iteration  12
[[  8.44834745e-01   1.55165255e-01]
 [  9.27157380e-04   9.99072843e-01]]
[[ 0.8587359   0.1412641 ]
 [ 0.09945783  0.90054217]]
Pi: [ 0.87385507  0.12614493]
-87794.4745446
rate: 0.612481743001 0.001
delta: 18.0000458018 0.001
small change times: 0
num iteration  13
[[  8.45225198e-01   1.54774802e-01]
 [  7.02088405e-04   9.99297912e-01]]
[[ 0.8585581   0.1414419 ]
 [ 0.09971698  0.90028302]]
Pi: [ 0.87362365  0.12637635]
-87783.1167825
rate: 0.630985176135 0.001
delta: 11.3577620707 0.001
small change times: 0
num iteration  14
[[  8.45502092e-01   1.54497908e-01]
 [  5.41983106e-04   9.99458017e-01]]
[[ 0.85840858  0.14159142]
 [ 0.09990085  0.90009915]]
Pi: [ 0.87348898  0.12651102]
-87775.7499073
rate: 0.648620313075 0.001
delta: 7.36687519011 0.001
small change times: 0
num iteration  15
[[  8.45702459e-01   1.54297541e-01]
 [  4.25768400e-04   9.99574232e-01]]
[[ 0.8582857   0.1417143 ]
 [ 0.10003415  0.89996585]]
Pi: [ 0.87340953  0.12659047]
-87770.8501982
rate: 0.665100055708 0.001
delta: 4.89970909934 0.001
small change times: 0
num iteration  16
[[  8.45850118e-01   1.54149882e-01]
 [  3.39854921e-04   9.99660145e-01]]
[[ 0.85818586  0.14181414]
 [ 0.10013273  0.89986727]]
Pi: [ 0.87336191  0.12663809]
-87767.5172176
rate: 0.680240522447 0.001
delta: 3.33298067757 0.001
small change times: 0
num iteration  17
[[  8.45960709e-01   1.54039291e-01]
 [  2.75287458e-04   9.99724713e-01]]
[[ 0.85810518  0.14189482]
 [ 0.10020698  0.89979302]]
Pi: [ 0.87333287  0.12666713]
-87765.2043502
rate: 0.693933635089 0.001
delta: 2.31286739727 0.001
small change times: 0
num iteration  18
[[  8.46044728e-01   1.53955272e-01]
 [  2.26039157e-04   9.99773961e-01]]
[[ 0.85804008  0.14195992]
 [ 0.10026382  0.89973618]]
Pi: [ 0.87331482  0.12668518]
-87763.5711023
rate: 0.706157150733 0.001
delta: 1.63324785128 0.001
small change times: 0
num iteration  19
[[  8.46109369e-01   1.53890631e-01]
 [  1.87971806e-04   9.99812028e-01]]
[[ 0.85798752  0.14201248]
 [ 0.10030799  0.89969201]]
Pi: [ 0.87330338  0.12669662]
-87762.4001082
rate: 0.716972703215 0.001
delta: 1.17099412695 0.001
small change times: 0
num iteration  20
[[  8.46159663e-01   1.53840337e-01]
 [  1.58190111e-04   9.99841810e-01]]
[[ 0.857945    0.142055  ]
 [ 0.10034278  0.89965722]]
Pi: [ 0.87329598  0.12670402]
-87761.5493704
rate: 0.726508984273 0.001
delta: 0.850737753761 0.001
small change times: 0
num iteration  21
[[  8.46199192e-01   1.53800808e-01]
 [  1.34632944e-04   9.99865367e-01]]
[[ 0.85791049  0.14208951]
 [ 0.10037054  0.89962946]]
Pi: [ 0.87329109  0.12670891]
-87760.9241305
rate: 0.734938480864 0.001
delta: 0.625239912362 0.001
small change times: 0
num iteration  22
[[  8.46230548e-01   1.53769452e-01]
 [  1.15809603e-04   9.99884190e-01]]
[[ 0.85788236  0.14211764]
 [ 0.10039293  0.89960707]]
Pi: [ 0.87328777  0.12671223]
-87760.4599185
rate: 0.742454305949 0.001
delta: 0.464212065184 0.001
small change times: 0
num iteration  23
[[  8.46255636e-01   1.53744364e-01]
 [  1.00626422e-04   9.99899374e-01]]
[[ 0.85785933  0.14214067]
 [ 0.10041118  0.89958882]]
Pi: [ 0.87328547  0.12671453]
-87760.1121075
rate: 0.749250217275 0.001
delta: 0.347810990701 0.001
small change times: 0
num iteration  24
[[  8.46275870e-01   1.53724130e-01]
 [  8.82706566e-05   9.99911729e-01]]
[[ 0.85784038  0.14215962]
 [ 0.1004262   0.8995738 ]]
Pi: [ 0.87328383  0.12671617]
-87759.8493345
rate: 0.755505028659 0.001
delta: 0.262772952497 0.001
small change times: 0
num iteration  25
[[  8.46292316e-01   1.53707684e-01]
 [  7.81313523e-05   9.99921869e-01]]
[[ 0.85782471  0.14217529]
 [ 0.10043869  0.89956131]]
Pi: [ 0.87328264  0.12671736]
-87759.6492666
rate: 0.761371862644 0.001
delta: 0.200067932295 0.001
small change times: 0
num iteration  26
[[  8.46305782e-01   1.53694218e-01]
 [  6.97444894e-05   9.99930256e-01]]
[[ 0.85781168  0.14218832]
 [ 0.10044914  0.89955086]]
Pi: [ 0.87328174  0.12671826]
-87759.49582
rate: 0.766972350728 0.001
delta: 0.153446572338 0.001
small change times: 0
num iteration  27
[[  8.46316886e-01   1.53683114e-01]
 [  6.27543606e-05   9.99937246e-01]]
[[ 0.85780077  0.14219923]
 [ 0.10045797  0.89954203]]
Pi: [ 0.87328105  0.12671895]
-87759.3772986
rate: 0.77239528361 0.001
delta: 0.11852140876 0.001
small change times: 0
num iteration  28
[[  8.46326107e-01   1.53673893e-01]
 [  5.68859731e-05   9.99943114e-01]]
[[ 0.8577916   0.1422084 ]
 [ 0.10046548  0.89953452]]
Pi: [ 0.87328051  0.12671949]
-87759.2851246
rate: 0.777698897493 0.001
delta: 0.092173968922 0.001
small change times: 0
num iteration  29
[[  8.46333815e-01   1.53666185e-01]
 [  5.19250683e-05   9.99948075e-01]]
[[ 0.85778384  0.14221616]
 [ 0.10047191  0.89952809]]
Pi: [ 0.87328007  0.12671993]
-87759.2129602
rate: 0.782915534185 0.001
delta: 0.0721644321166 0.001
small change times: 0
num iteration  30
[[  8.46340302e-01   1.53659698e-01]
 [  4.77034850e-05   9.99952297e-01]]
[[ 0.85777723  0.14222277]
 [ 0.10047746  0.89952254]]
Pi: [ 0.87327971  0.12672029]
-87759.1560905
rate: 0.788057428536 0.001
delta: 0.0568697168055 0.001
small change times: 0
num iteration  31
[[  8.46345795e-01   1.53654205e-01]
 [  4.40883246e-05   9.99955912e-01]]
[[ 0.85777158  0.14222842]
 [ 0.10048226  0.89951774]]
Pi: [ 0.87327941  0.12672059]
-87759.1109858
rate: 0.793122665162 0.001
delta: 0.0451046613598 0.001
small change times: 0
num iteration  32
[[  8.46350476e-01   1.53649524e-01]
 [  4.09738571e-05   9.99959026e-01]]
[[ 0.85776671  0.14223329]
 [ 0.10048645  0.89951355]]
Pi: [ 0.87327916  0.12672084]
-87759.0749878
rate: 0.798100404244 0.001
delta: 0.0359980484645 0.001
small change times: 0
num iteration  33
[[  8.46354489e-01   1.53645511e-01]
 [  3.82754259e-05   9.99961725e-01]]
[[ 0.8577625   0.1422375 ]
 [ 0.10049012  0.89950988]]
Pi: [ 0.87327894  0.12672106]
-87759.0460822
rate: 0.802975274809 0.001
delta: 0.0289055428584 0.001
small change times: 0
num iteration  34
[[  8.46357948e-01   1.53642052e-01]
 [  3.59248234e-05   9.99964075e-01]]
[[ 0.85775884  0.14224116]
 [ 0.10049336  0.89950664]]
Pi: [ 0.87327875  0.12672125]
-87759.0227343
rate: 0.807730493201 0.001
delta: 0.0233478883893 0.001
small change times: 0
num iteration  35
[[  8.46360945e-01   1.53639055e-01]
 [  3.38667600e-05   9.99966133e-01]]
[[ 0.85775564  0.14224436]
 [ 0.10049622  0.89950378]]
Pi: [ 0.87327859  0.12672141]
-87759.0037677
rate: 0.812350071294 0.001
delta: 0.0189666587976 0.001
small change times: 0
num iteration  36
[[  8.46363557e-01   1.53636443e-01]
 [  3.20561510e-05   9.99967944e-01]]
[[ 0.85775283  0.14224717]
 [ 0.10049876  0.89950124]]
Pi: [ 0.87327845  0.12672155]
-87758.9882753
rate: 0.816820201814 0.001
delta: 0.0154923500668 0.001
small change times: 0
num iteration  37
[[  8.46365844e-01   1.53634156e-01]
 [  3.04560195e-05   9.99969544e-01]]
[[ 0.85775035  0.14224965]
 [ 0.10050103  0.89949897]]
Pi: [ 0.87327832  0.12672168]
-87758.9755541
rate: 0.821129777016 0.001
delta: 0.0127212299558 0.001
small change times: 0
num iteration  38
[[  8.46367856e-01   1.53632144e-01]
 [  2.90358667e-05   9.99970964e-01]]
[[ 0.85774816  0.14225184]
 [ 0.10050305  0.89949695]]
Pi: [ 0.8732782  0.1267218]
-87758.9650556
rate: 0.825270743035 0.001
delta: 0.0104984588979 0.001
small change times: 0
num iteration  39
[[  8.46369634e-01   1.53630366e-01]
 [  2.77703985e-05   9.99972230e-01]]
[[ 0.8577462   0.1422538 ]
 [ 0.10050488  0.89949512]]
Pi: [ 0.8732781  0.1267219]
-87758.9563499
rate: 0.829237932323 0.001
delta: 0.0087057203491 0.001
small change times: 0
num iteration  40
[[  8.46371211e-01   1.53628789e-01]
 [  2.66385253e-05   9.99973361e-01]]
[[ 0.85774446  0.14225554]
 [ 0.10050652  0.89949348]]
Pi: [ 0.87327801  0.12672199]
-87758.9490978
rate: 0.833028867991 0.001
delta: 0.00725211636745 0.001
small change times: 0
num iteration  41
[[  8.46372616e-01   1.53627384e-01]
 [  2.56225714e-05   9.99974377e-01]]
[[ 0.8577429  0.1422571]
 [ 0.100508   0.899492 ]]
Pi: [ 0.87327793  0.12672207]
-87758.9430304
rate: 0.836643320555 0.001
delta: 0.00606743471872 0.001
small change times: 0
num iteration  42
[[  8.46373872e-01   1.53626128e-01]
 [  2.47076479e-05   9.99975292e-01]]
[[ 0.85774149  0.14225851]
 [ 0.10050935  0.89949065]]
Pi: [ 0.87327785  0.12672215]
-87758.9379332
rate: 0.84008285205 0.001
delta: 0.00509714786313 0.001
small change times: 0
num iteration  43
[[  8.46374999e-01   1.53625001e-01]
 [  2.38811529e-05   9.99976119e-01]]
[[ 0.85774023  0.14225977]
 [ 0.10051057  0.89948943]]
Pi: [ 0.87327778  0.12672222]
-87758.9336345
rate: 0.843350824416 0.001
delta: 0.00429868385254 0.001
small change times: 0
num iteration  44
[[  8.46376014e-01   1.53623986e-01]
 [  2.31323696e-05   9.99976868e-01]]
[[ 0.85773908  0.14226092]
 [ 0.10051168  0.89948832]]
Pi: [ 0.87327772  0.12672228]
-87758.9299959
rate: 0.846451555442 0.001
delta: 0.00363862763334 0.001
small change times: 0
num iteration  45
[[  8.46376930e-01   1.53623070e-01]
 [  2.24521433e-05   9.99977548e-01]]
[[ 0.85773804  0.14226196]
 [ 0.1005127   0.8994873 ]]
Pi: [ 0.87327767  0.12672233]
-87758.9269053
rate: 0.84939023695 0.001
delta: 0.00309061478765 0.001
small change times: 0
num iteration  46
[[  8.46377760e-01   1.53622240e-01]
 [  2.18326196e-05   9.99978167e-01]]
[[ 0.85773709  0.14226291]
 [ 0.10051363  0.89948637]]
Pi: [ 0.87327761  0.12672239]
-87758.9242716
rate: 0.852172887508 0.001
delta: 0.00263373812777 0.001
small change times: 0
num iteration  47
[[  8.46378513e-01   1.53621487e-01]
 [  2.12670313e-05   9.99978733e-01]]
[[ 0.85773623  0.14226377]
 [ 0.10051449  0.89948551]]
Pi: [ 0.87327757  0.12672243]
-87758.9220202
rate: 0.854806017993 0.001
delta: 0.00225133520144 0.001
small change times: 0
num iteration  48
[[  8.46379199e-01   1.53620801e-01]
 [  2.07495248e-05   9.99979250e-01]]
[[ 0.85773544  0.14226456]
 [ 0.10051527  0.89948473]]
Pi: [ 0.87327752  0.12672248]
-87758.9200902
rate: 0.857295522852 0.001
delta: 0.00193005958863 0.001
small change times: 0
num iteration  49
[[  8.46379825e-01   1.53620175e-01]
 [  2.02750164e-05   9.99979725e-01]]
[[ 0.85773472  0.14226528]
 [ 0.10051599  0.89948401]]
Pi: [ 0.87327748  0.12672252]
-87758.918431
rate: 0.859649112886 0.001
delta: 0.00165917401318 0.001
small change times: 0
num iteration  50
[[  8.46380397e-01   1.53619603e-01]
 [  1.98390754e-05   9.99980161e-01]]
[[ 0.85773406  0.14226594]
 [ 0.10051666  0.89948334]]
Pi: [ 0.87327745  0.12672255]
-87758.917001
rate: 0.861872481583 0.001
delta: 0.00142999642412 0.001
small change times: 0
num iteration  51
[[  8.46380922e-01   1.53619078e-01]
 [  1.94378255e-05   9.99980562e-01]]
[[ 0.85773345  0.14226655]
 [ 0.10051728  0.89948272]]
Pi: [ 0.87327741  0.12672259]
-87758.9157655
rate: 0.86397274222 0.001
delta: 0.00123547793191 0.001
small change times: 0
num iteration  52
[[  8.46381403e-01   1.53618597e-01]
 [  1.90678648e-05   9.99980932e-01]]
[[ 0.85773289  0.14226711]
 [ 0.10051784  0.89948216]]
Pi: [ 0.87327738  0.12672262]
-87758.9146956
rate: 0.865956363474 0.001
delta: 0.00106986997707 0.001
small change times: 0
num iteration  53
[[  8.46381847e-01   1.53618153e-01]
 [  1.87261968e-05   9.99981274e-01]]
[[ 0.85773237  0.14226763]
 [ 0.10051837  0.89948163]]
Pi: [ 0.87327735  0.12672265]
-87758.9137672
rate: 0.867829184094 0.001
delta: 0.00092846438929 0.001
small change times: 1
num iteration  54
[[  8.46382255e-01   1.53617745e-01]
 [  1.84101747e-05   9.99981590e-01]]
[[ 0.85773189  0.14226811]
 [ 0.10051886  0.89948114]]
Pi: [ 0.87327732  0.12672268]
-87758.9129598
rate: 0.869597880132 0.001
delta: 0.000807390664704 0.001
small change times: 2
num iteration  55
[[  8.46382632e-01   1.53617368e-01]
 [  1.81174527e-05   9.99981883e-01]]
[[ 0.85773145  0.14226855]
 [ 0.10051931  0.89948069]]
Pi: [ 0.8732773  0.1267227]
-87758.9122563
rate: 0.871267392389 0.001
delta: 0.000703453159076 0.001
small change times: 3
num iteration  56
[[  8.46382981e-01   1.53617019e-01]
 [  1.78459462e-05   9.99982154e-01]]
[[ 0.85773104  0.14226896]
 [ 0.10051974  0.89948026]]
Pi: [ 0.87327728  0.12672272]
-87758.9116423
rate: 0.872843972623 0.001
delta: 0.000614004849922 0.001
small change times: 4
num iteration  57
[[  8.46383304e-01   1.53616696e-01]
 [  1.75937973e-05   9.99982406e-01]]
[[ 0.85773065  0.14226935]
 [ 0.10052013  0.89947987]]
Pi: [ 0.87327725  0.12672275]
-87758.9111055
rate: 0.874332809437 0.001
delta: 0.00053684458544 0.001
small change times: 5
num iteration  58
[[  8.46383603e-01   1.53616397e-01]
 [  1.73593458e-05   9.99982641e-01]]
[[ 0.8577303  0.1422697]
 [ 0.1005205  0.8994795]]
Pi: [ 0.87327723  0.12672277]
-87758.9106354
rate: 0.875738645563 0.001
delta: 0.000470135550131 0.001
small change times: 6
==================================================
只有EM步骤迭代
HMM content: N = 2 ,M = 2
hmm.A  [ 0.8463836  0.1536164]  hmm.B  [ 0.8577303  0.1422697]
       [  1.73593458e-05   9.99982641e-01]         [ 0.1005205  0.8994795]
hmm.pi [ 0.87327723  0.12672277]
finalprob: -87758.9106354
iteration num: 59
totaltime: 60
==================================================
