python my HMM
['sparkpybkt_hdfs_beta3.py', '7', '7']
BaumWelch
user_num  10000
column_num 20
beta3
num iteration  0
[[ 0.3038026   0.6961974 ]
 [ 0.20026474  0.79973526]]
[[ 0.3834174   0.6165826 ]
 [ 0.28347541  0.71652459]]
Pi: [ 0.53531265  0.46468735]
-124074.594267
num iteration  0
[[ 0.30804274  0.69195726]
 [ 0.1965519   0.8034481 ]]
[[ 0.42394954  0.57605046]
 [ 0.27036396  0.72963604]]
Pi: [ 0.59059213  0.40940787]
-122607.543168
rate: 1.46705109982e+72 0.001
delta: 1467.05109982 0.001
small change times: 0
num iteration  1
[[ 0.31903075  0.68096925]
 [ 0.19013821  0.80986179]]
[[ 0.47301419  0.52698581]
 [ 0.25408912  0.74591088]]
Pi: [ 0.6668451  0.3331549]
-121920.644071
rate: 0.468217566686 0.001
delta: 686.899096161 0.001
small change times: 0
num iteration  2
[[ 0.34298197  0.65701803]
 [ 0.17984067  0.82015933]]
[[ 0.53256376  0.46743624]
 [ 0.23354477  0.76645523]]
Pi: [ 0.75520075  0.24479925]
-120790.789028
rate: 1.64486319714 0.001
delta: 1129.85504342 0.001
small change times: 0
num iteration  3
[[ 0.39061113  0.60938887]
 [ 0.1639918   0.8360082 ]]
[[ 0.60447056  0.39552944]
 [ 0.20686139  0.79313861]]
Pi: [ 0.83931159  0.16068841]
-118917.459481
rate: 1.65802645038 0.001
delta: 1873.32954709 0.001
small change times: 0
num iteration  4
[[ 0.47732271  0.52267729]
 [ 0.13987969  0.86012031]]
[[ 0.68946449  0.31053551]
 [ 0.16996901  0.83003099]]
Pi: [ 0.9029967  0.0970033]
-115583.86618
rate: 1.77950180004 0.001
delta: 3333.59330111 0.001
small change times: 0
num iteration  5
[[ 0.60238313  0.39761687]
 [ 0.10422642  0.89577358]]
[[ 0.77631502  0.22368498]
 [ 0.12146723  0.87853277]]
Pi: [ 0.93900389  0.06099611]
-109097.700666
rate: 1.94569790836 0.001
delta: 6486.16551328 0.001
small change times: 0
num iteration  6
[[ 0.70940847  0.29059153]
 [ 0.06596916  0.93403084]]
[[ 0.83418551  0.16581449]
 [ 0.08402015  0.91597985]]
Pi: [ 0.94800592  0.05199408]
-99269.011316
rate: 1.51533125855 0.001
delta: 9828.68935042 0.001
small change times: 0
num iteration  7
[[ 0.76638999  0.23361001]
 [ 0.04132053  0.95867947]]
[[ 0.85482447  0.14517553]
 [ 0.07395184  0.92604816]]
Pi: [ 0.93625406  0.06374594]
-92597.1875442
rate: 0.678811134831 0.001
delta: 6671.82377185 0.001
small change times: 0
num iteration  8
[[ 0.79639428  0.20360572]
 [ 0.02692083  0.97307917]]
[[ 0.8592443   0.1407557 ]
 [ 0.07740905  0.92259095]]
Pi: [ 0.91674194  0.08325806]
-90383.5207842
rate: 0.331793350024 0.001
delta: 2213.66676003 0.001
small change times: 0
num iteration  9
[[ 0.81468733  0.18531267]
 [ 0.01750987  0.98249013]]
[[ 0.86019579  0.13980421]
 [ 0.0835544   0.9164456 ]]
Pi: [ 0.90053837  0.09946163]
-89355.9156498
rate: 0.464209497536 0.001
delta: 1027.60513439 0.001
small change times: 0
num iteration  10
[[ 0.82625323  0.17374677]
 [ 0.01129108  0.98870892]]
[[ 0.8604777   0.1395223 ]
 [ 0.08885381  0.91114619]]
Pi: [ 0.88988845  0.11011155]
-88708.0478664
rate: 0.630463746874 0.001
delta: 647.867783332 0.001
small change times: 0
num iteration  11
[[ 0.8334846   0.1665154 ]
 [ 0.00730971  0.99269029]]
[[ 0.86044861  0.13955139]
 [ 0.0926669   0.9073331 ]]
Pi: [ 0.88329442  0.11670558]
-88312.0108551
rate: 0.611292954333 0.001
delta: 396.03701129 0.001
small change times: 0
num iteration  12
[[ 0.83796568  0.16203432]
 [ 0.00481219  0.99518781]]
[[ 0.86021523  0.13978477]
 [ 0.09522162  0.90477838]]
Pi: [ 0.87926532  0.12073468]
-88082.0422222
rate: 0.580674599598 0.001
delta: 229.968632957 0.001
small change times: 0
num iteration  13
[[ 0.84075623  0.15924377]
 [ 0.00324498  0.99675502]]
[[ 0.85988447  0.14011553]
 [ 0.09689309  0.90310691]]
Pi: [ 0.87683372  0.12316628]
-87951.4555729
rate: 0.567845482371 0.001
delta: 130.586649312 0.001
small change times: 0
num iteration  14
[[ 0.84252251  0.15747749]
 [ 0.00224679  0.99775321]]
[[ 0.85953766  0.14046234]
 [ 0.09798665  0.90201335]]
Pi: [ 0.87538607  0.12461393]
-87876.9297119
rate: 0.570700461356 0.001
delta: 74.525861009 0.001
small change times: 0
num iteration  15
[[ 0.84366572  0.15633428]
 [ 0.00159687  0.99840313]]
[[ 0.85921892  0.14078108]
 [ 0.09871053  0.90128947]]
Pi: [ 0.87453234  0.12546766]
-87833.4780698
rate: 0.583041127562 0.001
delta: 43.4516420352 0.001
small change times: 0
num iteration  16
[[ 0.84442413  0.15557587]
 [ 0.00116328  0.99883672]]
[[ 0.85894498  0.14105502]
 [ 0.09919818  0.90080182]]
Pi: [ 0.87403048  0.12596952]
-87807.420354
rate: 0.599694616186 0.001
delta: 26.057715793 0.001
small change times: 0
num iteration  17
[[  8.44939955e-01   1.55060045e-01]
 [  8.66901212e-04   9.99133099e-01]]
[[ 0.85871766  0.14128234]
 [ 0.09953339  0.90046661]]
Pi: [ 0.87373471  0.12626529]
-87791.3249987
rate: 0.61768097471 0.001
delta: 16.0953552897 0.001
small change times: 0
num iteration  18
[[  8.45299316e-01   1.54700684e-01]
 [  6.59549934e-04   9.99340450e-01]]
[[ 0.85853248  0.14146752]
 [ 0.09976871  0.90023129]]
Pi: [ 0.87355919  0.12644081]
-87781.0949262
rate: 0.635591597342 0.001
delta: 10.2300725784 0.001
small change times: 0
num iteration  19
[[  8.45555311e-01   1.54444689e-01]
 [  5.11320020e-04   9.99488680e-01]]
[[ 0.85838301  0.14161699]
 [ 0.09993735  0.90006265]]
Pi: [ 0.87345399  0.12654601]
-87774.4170372
rate: 0.652770438294 0.001
delta: 6.67788896077 0.001
small change times: 0
num iteration  20
[[  8.45741384e-01   1.54258616e-01]
 [  4.03242466e-04   9.99596758e-01]]
[[ 0.8582629  0.1417371]
 [ 0.1000606  0.8999394]]
Pi: [ 0.87339019  0.12660981]
-87769.9504953
rate: 0.668855375236 0.001
delta: 4.46654192664 0.001
small change times: 0
num iteration  21
[[  8.45879075e-01   1.54120925e-01]
 [  3.23021456e-04   9.99676979e-01]]
[[ 0.85816652  0.14183348]
 [ 0.10015235  0.89984765]]
Pi: [ 0.87335097  0.12664903]
-87766.8970731
rate: 0.683621077518 0.001
delta: 3.05342220467 0.001
small change times: 0
num iteration  22
[[  8.45982580e-01   1.54017420e-01]
 [  2.62513250e-04   9.99737487e-01]]
[[ 0.85808916  0.14191084]
 [ 0.10022183  0.89977817]]
Pi: [ 0.87332652  0.12667348]
-87764.7689907
rate: 0.696949926416 0.001
delta: 2.12808238086 0.001
small change times: 0
num iteration  23
[[  8.46061470e-01   1.53938530e-01]
 [  2.16210568e-04   9.99783789e-01]]
[[ 0.85802696  0.14197304]
 [ 0.10027526  0.89972474]]
Pi: [ 0.87331104  0.12668896]
-87763.2605488
rate: 0.708826838524 0.001
delta: 1.50844190615 0.001
small change times: 0
num iteration  24
[[  8.46122339e-01   1.53877661e-01]
 [  1.80314714e-04   9.99819685e-01]]
[[ 0.85797683  0.14202317]
 [ 0.10031694  0.89968306]]
Pi: [ 0.87330106  0.12669894]
-87762.1754886
rate: 0.7193251615 0.001
delta: 1.08506021775 0.001
small change times: 0
num iteration  25
[[  8.46169818e-01   1.53830182e-01]
 [  1.52156702e-04   9.99847843e-01]]
[[ 0.85793629  0.14206371]
 [ 0.10034988  0.89965012]]
Pi: [ 0.87329451  0.12670549]
-87761.3849316
rate: 0.728583495545 0.001
delta: 0.790556966327 0.001
small change times: 0
num iteration  26
[[  8.46207219e-01   1.53792781e-01]
 [  1.29829154e-04   9.99870171e-01]]
[[ 0.85790338  0.14209662]
 [ 0.10037624  0.89962376]]
Pi: [ 0.87329013  0.12670987]
-87760.802465
rate: 0.73678010404 0.001
delta: 0.5824666439 0.001
small change times: 0
num iteration  27
[[  8.46236950e-01   1.53763050e-01]
 [  1.11947737e-04   9.99888052e-01]]
[[ 0.85787654  0.14212346]
 [ 0.10039755  0.89960245]]
Pi: [ 0.87328713  0.12671287]
-87760.369046
rate: 0.744109461232 0.001
delta: 0.433418940578 0.001
small change times: 0
num iteration  28
[[  8.46260784e-01   1.53739216e-01]
 [  9.74936185e-05   9.99902506e-01]]
[[ 0.85785455  0.14214545]
 [ 0.10041497  0.89958503]]
Pi: [ 0.87328502  0.12671498]
-87760.0436512
rate: 0.750762865523 0.001
delta: 0.3253948458 0.001
small change times: 0
num iteration  29
[[  8.46280043e-01   1.53719957e-01]
 [  8.57075343e-05   9.99914292e-01]]
[[ 0.85783643  0.14216357]
 [ 0.10042935  0.89957065]]
Pi: [ 0.87328351  0.12671649]
-87759.7973553
rate: 0.756913802965 0.001
delta: 0.2462958502 0.001
small change times: 0
num iteration  30
[[  8.46295723e-01   1.53704277e-01]
 [  7.60172885e-05   9.99923983e-01]]
[[ 0.85782143  0.14217857]
 [ 0.10044131  0.89955869]]
Pi: [ 0.8732824  0.1267176]
-87759.6095034
rate: 0.76270831838 0.001
delta: 0.18785189373 0.001
small change times: 0
num iteration  31
[[  8.46308584e-01   1.53691416e-01]
 [  6.79873144e-05   9.99932013e-01]]
[[ 0.85780894  0.14219106]
 [ 0.10045135  0.89954865]]
Pi: [ 0.87328156  0.12671844]
-87759.4651843
rate: 0.768260277658 0.001
delta: 0.144319148036 0.001
small change times: 0
num iteration  32
[[  8.46319207e-01   1.53680793e-01]
 [  6.12830289e-05   9.99938717e-01]]
[[ 0.85779848  0.14220152]
 [ 0.10045985  0.89954015]]
Pi: [ 0.87328091  0.12671909]
-87759.3535316
rate: 0.773650976417 0.001
delta: 0.111652649794 0.001
small change times: 0
num iteration  33
[[  8.46328042e-01   1.53671958e-01]
 [  5.56452819e-05   9.99944355e-01]]
[[ 0.85778966  0.14221034]
 [ 0.10046708  0.89953292]]
Pi: [ 0.87328039  0.12671961]
-87759.2665618
rate: 0.778932083603 0.001
delta: 0.0869698311435 0.001
small change times: 0
num iteration  34
[[  8.46335440e-01   1.53664560e-01]
 [  5.08718035e-05   9.99949128e-01]]
[[ 0.85778219  0.14221781]
 [ 0.10047329  0.89952671]]
Pi: [ 0.87327998  0.12672002]
-87759.1983661
rate: 0.784130670029 0.001
delta: 0.0681957119668 0.001
small change times: 0
num iteration  35
[[  8.46341675e-01   1.53658325e-01]
 [  4.68035784e-05   9.99953196e-01]]
[[ 0.85777583  0.14222417]
 [ 0.10047865  0.89952135]]
Pi: [ 0.87327964  0.12672036]
-87759.1445423
rate: 0.789255133831 0.001
delta: 0.0538238157751 0.001
small change times: 0
num iteration  36
[[  8.46346963e-01   1.53653037e-01]
 [  4.33147371e-05   9.99956685e-01]]
[[ 0.85777037  0.14222963]
 [ 0.1004833   0.8995167 ]]
Pi: [ 0.87327935  0.12672065]
-87759.10179
rate: 0.794301002124 0.001
delta: 0.0427523108083 0.001
small change times: 0
num iteration  37
[[  8.46351475e-01   1.53648525e-01]
 [  4.03049888e-05   9.99959695e-01]]
[[ 0.85776567  0.14223433]
 [ 0.10048736  0.89951264]]
Pi: [ 0.8732791  0.1267209]
-87759.0676199
rate: 0.799256045754 0.001
delta: 0.0341700428835 0.001
small change times: 0
num iteration  38
[[  8.46355348e-01   1.53644652e-01]
 [  3.76939129e-05   9.99962306e-01]]
[[ 0.8577616   0.1422384 ]
 [ 0.10049092  0.89950908]]
Pi: [ 0.8732789  0.1267211]
-87759.0401436
rate: 0.804104303727 0.001
delta: 0.0274762785411 0.001
small change times: 0
num iteration  39
[[  8.46358691e-01   1.53641309e-01]
 [  3.54166215e-05   9.99964583e-01]]
[[ 0.85775805  0.14224195]
 [ 0.10049406  0.89950594]]
Pi: [ 0.87327871  0.12672129]
-87759.01792
rate: 0.808829005843 0.001
delta: 0.0222236110567 0.001
small change times: 0
num iteration  40
[[  8.46361592e-01   1.53638408e-01]
 [  3.34204417e-05   9.99966580e-01]]
[[ 0.85775495  0.14224505]
 [ 0.10049684  0.89950316]]
Pi: [ 0.87327855  0.12672145]
-87758.999843
rate: 0.813414623301 0.001
delta: 0.0180770102161 0.001
small change times: 0
num iteration  41
[[  8.46364122e-01   1.53635878e-01]
 [  3.16623634e-05   9.99968338e-01]]
[[ 0.85775222  0.14224778]
 [ 0.10049932  0.89950068]]
Pi: [ 0.87327841  0.12672159]
-87758.9850588
rate: 0.817847889067 0.001
delta: 0.0147842446459 0.001
small change times: 0
num iteration  42
[[  8.46366340e-01   1.53633660e-01]
 [  3.01070641e-05   9.99969893e-01]]
[[ 0.85774981  0.14225019]
 [ 0.10050152  0.89949848]]
Pi: [ 0.87327829  0.12672171]
-87758.9729044
rate: 0.822118440992 0.001
delta: 0.0121544001595 0.001
small change times: 0
num iteration  43
[[  8.46368294e-01   1.53631706e-01]
 [  2.87253716e-05   9.99971275e-01]]
[[ 0.85774768  0.14225232]
 [ 0.1005035   0.8994965 ]]
Pi: [ 0.87327818  0.12672182]
-87758.9628622
rate: 0.826218936385 0.001
delta: 0.0100421955722 0.001
small change times: 0
num iteration  44
[[  8.46370021e-01   1.53629979e-01]
 [  2.74930613e-05   9.99972507e-01]]
[[ 0.85774578  0.14225422]
 [ 0.10050528  0.89949472]]
Pi: [ 0.87327808  0.12672192]
-87758.9545257
rate: 0.83014485735 0.001
delta: 0.00833647701074 0.001
small change times: 0
num iteration  45
[[  8.46371556e-01   1.53628444e-01]
 [  2.63899100e-05   9.99973610e-01]]
[[ 0.85774408  0.14225592]
 [ 0.10050688  0.89949312]]
Pi: [ 0.87327799  0.12672201]
-87758.947574
rate: 0.833894216821 0.001
delta: 0.00695173996792 0.001
small change times: 0
num iteration  46
[[  8.46372924e-01   1.53627076e-01]
 [  2.53989484e-05   9.99974601e-01]]
[[ 0.85774255  0.14225745]
 [ 0.10050833  0.89949167]]
Pi: [ 0.87327791  0.12672209]
-87758.9417521
rate: 0.837467334653 0.001
delta: 0.00582185514213 0.001
small change times: 0
num iteration  47
[[  8.46374148e-01   1.53625852e-01]
 [  2.45058662e-05   9.99975494e-01]]
[[ 0.85774118  0.14225882]
 [ 0.10050965  0.89949035]]
Pi: [ 0.87327784  0.12672216]
-87758.9368567
rate: 0.840866271023 0.001
delta: 0.0048954016238 0.001
small change times: 0
num iteration  48
[[  8.46375247e-01   1.53624753e-01]
 [  2.36985371e-05   9.99976301e-01]]
[[ 0.85773995  0.14226005]
 [ 0.10051084  0.89948916]]
Pi: [ 0.87327777  0.12672223]
-87758.9327245
rate: 0.84409445433 0.001
delta: 0.00413218136237 0.001
small change times: 0
num iteration  49
[[  8.46376238e-01   1.53623762e-01]
 [  2.29666382e-05   9.99977033e-01]]
[[ 0.85773883  0.14226117]
 [ 0.10051193  0.89948807]]
Pi: [ 0.87327771  0.12672229]
-87758.9292239
rate: 0.847156557131 0.001
delta: 0.00350060453638 0.001
small change times: 0
num iteration  50
[[  8.46377132e-01   1.53622868e-01]
 [  2.23013420e-05   9.99977699e-01]]
[[ 0.85773781  0.14226219]
 [ 0.10051293  0.89948707]]
Pi: [ 0.87327765  0.12672235]
-87758.9262482
rate: 0.85005813858 0.001
delta: 0.0029757173761 0.001
small change times: 0
num iteration  51
[[  8.46377943e-01   1.53622057e-01]
 [  2.16950671e-05   9.99978305e-01]]
[[ 0.85773688  0.14226312]
 [ 0.10051384  0.89948616]]
Pi: [ 0.8732776  0.1267224]
-87758.9237105
rate: 0.852805006976 0.001
delta: 0.00253770667769 0.001
small change times: 0
num iteration  52
[[  8.46378680e-01   1.53621320e-01]
 [  2.11412754e-05   9.99978859e-01]]
[[ 0.85773604  0.14226396]
 [ 0.10051468  0.89948532]]
Pi: [ 0.87327756  0.12672244]
-87758.9215397
rate: 0.855403652305 0.001
delta: 0.00217076356057 0.001
small change times: 0
num iteration  53
[[  8.46379351e-01   1.53620649e-01]
 [  2.06343061e-05   9.99979366e-01]]
[[ 0.85773527  0.14226473]
 [ 0.10051545  0.89948455]]
Pi: [ 0.87327751  0.12672249]
-87758.9196775
rate: 0.857860823436 0.001
delta: 0.00186221301556 0.001
small change times: 0
num iteration  54
[[  8.46379964e-01   1.53620036e-01]
 [  2.01692388e-05   9.99979831e-01]]
[[ 0.85773456  0.14226544]
 [ 0.10051616  0.89948384]]
Pi: [ 0.87327747  0.12672253]
-87758.9180757
rate: 0.860183070285 0.001
delta: 0.00160184410925 0.001
small change times: 0
num iteration  55
[[  8.46380524e-01   1.53619476e-01]
 [  1.97417812e-05   9.99980258e-01]]
[[ 0.85773391  0.14226609]
 [ 0.10051681  0.89948319]]
Pi: [ 0.87327744  0.12672256]
-87758.9166943
rate: 0.862376975634 0.001
delta: 0.00138139347837 0.001
small change times: 0
num iteration  56
[[  8.46381039e-01   1.53618961e-01]
 [  1.93481753e-05   9.99980652e-01]]
[[ 0.85773331  0.14226669]
 [ 0.10051741  0.89948259]]
Pi: [ 0.8732774  0.1267226]
-87758.9155001
rate: 0.864449259921 0.001
delta: 0.00119414457004 0.001
small change times: 0
num iteration  57
[[  8.46381511e-01   1.53618489e-01]
 [  1.89851199e-05   9.99981015e-01]]
[[ 0.85773276  0.14226724]
 [ 0.10051797  0.89948203]]
Pi: [ 0.87327737  0.12672263]
-87758.9144655
rate: 0.866406120618 0.001
delta: 0.00103461416438 0.001
small change times: 0
num iteration  58
[[  8.46381946e-01   1.53618054e-01]
 [  1.86497058e-05   9.99981350e-01]]
[[ 0.85773225  0.14226775]
 [ 0.10051849  0.89948151]]
Pi: [ 0.87327735  0.12672265]
-87758.9135672
rate: 0.868254198028 0.001
delta: 0.000898308091564 0.001
small change times: 1
num iteration  59
[[  8.46382346e-01   1.53617654e-01]
 [  1.83393606e-05   9.99981661e-01]]
[[ 0.85773178  0.14226822]
 [ 0.10051897  0.89948103]]
Pi: [ 0.87327732  0.12672268]
-87758.9127857
rate: 0.869998721231 0.001
delta: 0.000781526890933 0.001
small change times: 2
num iteration  60
[[  8.46382717e-01   1.53617283e-01]
 [  1.80518035e-05   9.99981948e-01]]
[[ 0.85773135  0.14226865]
 [ 0.10051942  0.89948058]]
Pi: [ 0.87327729  0.12672271]
-87758.9121045
rate: 0.871646525045 0.001
delta: 0.000681215198711 0.001
small change times: 3
num iteration  61
[[  8.46383059e-01   1.53616941e-01]
 [  1.77850061e-05   9.99982215e-01]]
[[ 0.85773094  0.14226906]
 [ 0.10051983  0.89948017]]
Pi: [ 0.87327727  0.12672273]
-87758.9115096
rate: 0.873201601136 0.001
delta: 0.000594838202232 0.001
small change times: 4
num iteration  62
[[  8.46383376e-01   1.53616624e-01]
 [  1.75371592e-05   9.99982463e-01]]
[[ 0.85773057  0.14226943]
 [ 0.10052022  0.89947978]]
Pi: [ 0.87327725  0.12672275]
-87758.9109893
rate: 0.874670309468 0.001
delta: 0.00052028731443 0.001
small change times: 5
num iteration  63
[[  8.46383670e-01   1.53616330e-01]
 [  1.73066455e-05   9.99982693e-01]]
[[ 0.85773022  0.14226978]
 [ 0.10052058  0.89947942]]
Pi: [ 0.87327723  0.12672277]
-87758.9105335
rate: 0.87605753581 0.001
delta: 0.000455801622593 0.001
small change times: 6
==================================================
只有EM步骤迭代
HMM content: N = 2 ,M = 2
hmm.A  [ 0.84638367  0.15361633]  hmm.B  [ 0.85773022  0.14226978]
       [  1.73066455e-05   9.99982693e-01]         [ 0.10052058  0.89947942]
hmm.pi [ 0.87327723  0.12672277]
finalprob: -87758.9105335
iteration num: 64
totaltime: 63
==================================================
