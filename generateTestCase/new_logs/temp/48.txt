python my HMM
['sparkpybkt_hdfs_beta3.py', '4', '8']
BaumWelch
user_num  10000
column_num 20
beta3
num iteration  0
[[ 0.59783099  0.40216901]
 [ 0.19726161  0.80273839]]
[[ 0.26516412  0.73483588]
 [ 0.32919297  0.67080703]]
Pi: [ 0.44303765  0.55696235]
-126487.24434
num iteration  0
[[ 0.60483115  0.39516885]
 [ 0.19986819  0.80013181]]
[[ 0.25594588  0.74405412]
 [ 0.33415502  0.66584498]]
Pi: [ 0.39281159  0.60718841]
-123437.256659
rate: 3.04998768081e+72 0.001
delta: 3049.98768081 0.001
small change times: 0
num iteration  1
[[ 0.61488828  0.38511172]
 [ 0.202782    0.797218  ]]
[[ 0.23718748  0.76281252]
 [ 0.34436023  0.65563977]]
Pi: [ 0.33457103  0.66542897]
-123234.559098
rate: 0.0664584853149 0.001
delta: 202.697561496 0.001
small change times: 0
num iteration  2
[[ 0.63194657  0.36805343]
 [ 0.20623513  0.79376487]]
[[ 0.20541452  0.79458548]
 [ 0.36253619  0.63746381]]
Pi: [ 0.26287198  0.73712802]
-122761.187207
rate: 2.33536056093 0.001
delta: 473.371890914 0.001
small change times: 0
num iteration  3
[[ 0.66327671  0.33672329]
 [ 0.21026017  0.78973983]]
[[ 0.15935395  0.84064605]
 [ 0.39254275  0.60745725]]
Pi: [ 0.17893499  0.82106501]
-121590.140364
rate: 2.47384110608 0.001
delta: 1171.0468422 0.001
small change times: 0
num iteration  4
[[ 0.71762818  0.28237182]
 [ 0.2143811   0.7856189 ]]
[[ 0.10631371  0.89368629]
 [ 0.43969386  0.56030614]]
Pi: [ 0.09941816  0.90058184]
-118922.460053
rate: 2.27803040473 0.001
delta: 2667.6803119 0.001
small change times: 0
num iteration  5
[[ 0.79304849  0.20695151]
 [ 0.21665539  0.78334461]]
[[ 0.06311858  0.93688142]
 [ 0.51071641  0.48928359]]
Pi: [ 0.04726984  0.95273016]
-113820.576485
rate: 1.91247937212 0.001
delta: 5101.88356792 0.001
small change times: 0
num iteration  6
[[ 0.86552207  0.13447793]
 [ 0.21398716  0.78601284]]
[[ 0.04044146  0.95955854]
 [ 0.60301545  0.39698455]]
Pi: [ 0.02423103  0.97576897]
-106386.932067
rate: 1.45703921277 0.001
delta: 7433.64441744 0.001
small change times: 0
num iteration  7
[[ 0.91244525  0.08755475]
 [ 0.20910308  0.79089692]]
[[ 0.03511146  0.96488854]
 [ 0.68904142  0.31095858]]
Pi: [ 0.01706831  0.98293169]
-99247.6197999
rate: 0.960405403642 0.001
delta: 7139.31226726 0.001
small change times: 0
num iteration  8
[[ 0.93809253  0.06190747]
 [ 0.20596236  0.79403764]]
[[ 0.04085736  0.95914264]
 [ 0.74812054  0.25187946]]
Pi: [ 0.01740646  0.98259354]
-95072.465044
rate: 0.584811897779 0.001
delta: 4175.15475585 0.001
small change times: 0
num iteration  9
[[ 0.9551738   0.0448262 ]
 [ 0.20172095  0.79827905]]
[[ 0.05236525  0.94763475]
 [ 0.78594405  0.21405595]]
Pi: [ 0.02309598  0.97690402]
-92919.3640114
rate: 0.515693706838 0.001
delta: 2153.10103267 0.001
small change times: 0
num iteration  10
[[ 0.96868088  0.03131912]
 [ 0.19441602  0.80558398]]
[[ 0.06492366  0.93507634]
 [ 0.81157003  0.18842997]]
Pi: [ 0.03506427  0.96493573]
-91363.7592335
rate: 0.722495021936 0.001
delta: 1555.60477783 0.001
small change times: 0
num iteration  11
[[ 0.9790355   0.0209645 ]
 [ 0.18517147  0.81482853]]
[[ 0.07564253  0.92435747]
 [ 0.82959101  0.17040899]]
Pi: [ 0.05401898  0.94598102]
-90115.9465699
rate: 0.802139901774 0.001
delta: 1247.81266369 0.001
small change times: 0
num iteration  12
[[ 0.98633668  0.01366332]
 [ 0.17606406  0.82393594]]
[[ 0.08369476  0.91630524]
 [ 0.84216521  0.15783479]]
Pi: [ 0.0764027  0.9235973]
-89184.0846344
rate: 0.746796344195 0.001
delta: 931.861935481 0.001
small change times: 0
num iteration  13
[[ 0.99115705  0.00884295]
 [ 0.16873569  0.83126431]]
[[ 0.08935985  0.91064015]
 [ 0.85031846  0.14968154]]
Pi: [ 0.09577729  0.90422271]
-88566.0713496
rate: 0.663202628203 0.001
delta: 618.013284734 0.001
small change times: 0
num iteration  14
[[ 0.99422018  0.00577982]
 [ 0.16362803  0.83637197]]
[[ 0.09318187  0.90681813]
 [ 0.85499771  0.14500229]]
Pi: [ 0.10903572  0.89096428]
-88206.3067507
rate: 0.582130850255 0.001
delta: 359.764598911 0.001
small change times: 0
num iteration  15
[[ 0.99614352  0.00385648]
 [ 0.16030483  0.83969517]]
[[ 0.0956741   0.9043259 ]
 [ 0.85735409  0.14264591]]
Pi: [ 0.11697218  0.88302782]
-88012.3838716
rate: 0.539027129875 0.001
delta: 193.922879182 0.001
small change times: 0
num iteration  16
[[ 0.99736066  0.00263934]
 [ 0.15817508  0.84182492]]
[[ 0.09726604  0.90273396]
 [ 0.85837982  0.14162018]]
Pi: [ 0.12142191  0.87857809]
-87908.5243827
rate: 0.5355710955 0.001
delta: 103.859488846 0.001
small change times: 0
num iteration  17
[[ 0.99814551  0.00185449]
 [ 0.15679629  0.84320371]]
[[ 0.09828013  0.90171987]
 [ 0.85872766  0.14127234]]
Pi: [ 0.12384381  0.87615619]
-87851.0081011
rate: 0.553789377214 0.001
delta: 57.5162816457 0.001
small change times: 0
num iteration  18
[[ 0.99866354  0.00133646]
 [ 0.1558864   0.8441136 ]]
[[ 0.09893428  0.90106572]
 [ 0.8587637   0.1412363 ]]
Pi: [ 0.12514729  0.87485271]
-87817.7279774
rate: 0.57862091711 0.001
delta: 33.2801236346 0.001
small change times: 0
num iteration  19
[[  9.99013877e-01   9.86123352e-04]
 [  1.55272656e-01   8.44727344e-01]]
[[ 0.09936573  0.90063427]
 [ 0.85867369  0.14132631]]
Pi: [ 0.12584848  0.87415152]
-87797.6658185
rate: 0.602827055337 0.001
delta: 20.0621589319 0.001
small change times: 0
num iteration  20
[[  9.99256489e-01   7.43511405e-04]
 [  1.54849247e-01   8.45150753e-01]]
[[ 0.09965797  0.90034203]
 [ 0.85854494  0.14145506]]
Pi: [ 0.12622822  0.87377178]
-87785.1366457
rate: 0.624517670051 0.001
delta: 12.5291727523 0.001
small change times: 0
num iteration  21
[[  9.99428294e-01   5.71706091e-04]
 [  1.54550665e-01   8.45449335e-01]]
[[ 0.0998614   0.9001386 ]
 [ 0.85841528  0.14158472]]
Pi: [ 0.1264364  0.8735636]
-87777.0697636
rate: 0.643847947637 0.001
delta: 8.06688216218 0.001
small change times: 0
num iteration  22
[[  9.99552486e-01   4.47513631e-04]
 [  1.54335719e-01   8.45664281e-01]]
[[ 0.10000672  0.89999328]
 [ 0.85829912  0.14170088]]
Pi: [ 0.12655241  0.87344759]
-87771.7355436
rate: 0.661249268601 0.001
delta: 5.33421992963 0.001
small change times: 0
num iteration  23
[[  9.99643955e-01   3.56044864e-04]
 [  1.54178043e-01   8.45821957e-01]]
[[ 0.10011298  0.89988702]
 [ 0.85820038  0.14179962]]
Pi: [ 0.12661834  0.87338166]
-87768.1244749
rate: 0.676962851747 0.001
delta: 3.61106873541 0.001
small change times: 0
num iteration  24
[[  9.99712467e-01   2.87532658e-04]
 [  1.54060419e-01   8.45939581e-01]]
[[ 0.10019234  0.89980766]
 [ 0.85811859  0.14188141]]
Pi: [ 0.12665666  0.87334334]
-87765.6289362
rate: 0.691080379712 0.001
delta: 2.49553875283 0.001
small change times: 0
num iteration  25
[[  9.99764567e-01   2.35432730e-04]
 [  1.53971360e-01   8.46028640e-01]]
[[ 0.1002527   0.8997473 ]
 [ 0.85805168  0.14194832]]
Pi: [ 0.12667947  0.87332053]
-87763.8729312
rate: 0.703657653539 0.001
delta: 1.75600494313 0.001
small change times: 0
num iteration  26
[[  9.99804730e-01   1.95270345e-04]
 [  1.53903042e-01   8.46096958e-01]]
[[ 0.10029938  0.89970062]
 [ 0.85799726  0.14200274]]
Pi: [ 0.1266934  0.8733066]
-87762.6177735
rate: 0.714780307262 0.001
delta: 1.25515775281 0.001
small change times: 0
num iteration  27
[[  9.99836073e-01   1.63926924e-04]
 [  1.53850022e-01   8.46149978e-01]]
[[ 0.10033601  0.89966399]
 [ 0.85795306  0.14204694]]
Pi: [ 0.12670214  0.87329786]
-87761.7083097
rate: 0.724581231918 0.001
delta: 0.909463750781 0.001
small change times: 0
num iteration  28
[[  9.99860810e-01   1.39190289e-04]
 [  1.53808444e-01   8.46191556e-01]]
[[ 0.10036512  0.89963488]
 [ 0.85791712  0.14208288]]
Pi: [ 0.12670777  0.87329223]
-87761.0414616
rate: 0.733232197967 0.001
delta: 0.666848104956 0.001
small change times: 0
num iteration  29
[[  9.99880534e-01   1.19465666e-04]
 [  1.53775527e-01   8.46224473e-01]]
[[ 0.10038855  0.89961145]
 [ 0.85788781  0.14211219]]
Pi: [ 0.1267115  0.8732885]
-87760.5473763
rate: 0.740926299348 0.001
delta: 0.494085298633 0.001
small change times: 0
num iteration  30
[[  9.99896414e-01   1.03586436e-04]
 [  1.53749240e-01   8.46250760e-01]]
[[ 0.1004076   0.8995924 ]
 [ 0.85786382  0.14213618]]
Pi: [ 0.12671405  0.87328595]
-87760.1778699
rate: 0.747859599399 0.001
delta: 0.369506433504 0.001
small change times: 0
num iteration  31
[[  9.99909312e-01   9.06879020e-05]
 [  1.53728074e-01   8.46271926e-01]]
[[ 0.10042325  0.89957675]
 [ 0.85784409  0.14215591]]
Pi: [ 0.12671584  0.87328416]
-87759.8991824
rate: 0.754215512798 0.001
delta: 0.278687484228 0.001
small change times: 0
num iteration  32
[[  9.99919878e-01   8.01215662e-05]
 [  1.53710899e-01   8.46289101e-01]]
[[ 0.10043622  0.89956378]
 [ 0.85782779  0.14217221]]
Pi: [ 0.12671713  0.87328287]
-87759.6873372
rate: 0.760153404875 0.001
delta: 0.211845240032 0.001
small change times: 0
num iteration  33
[[  9.99928604e-01   7.13959268e-05]
 [  1.53696859e-01   8.46303141e-01]]
[[ 0.10044707  0.89955293]
 [ 0.85781425  0.14218575]]
Pi: [ 0.12671809  0.87328191]
-87759.5251057
rate: 0.765801880911 0.001
delta: 0.162231483278 0.001
small change times: 0
num iteration  34
[[  9.99935865e-01   6.41349215e-05]
 [  1.53685298e-01   8.46314702e-01]]
[[ 0.10045622  0.89954378]
 [ 0.85780293  0.14219707]]
Pi: [ 0.12671882  0.87328118]
-87759.3999836
rate: 0.771256639402 0.001
delta: 0.125122108599 0.001
small change times: 0
num iteration  35
[[  9.99941952e-01   5.80483248e-05]
 [  1.53675712e-01   8.46324288e-01]]
[[ 0.10046399  0.89953601]
 [ 0.85779342  0.14220658]]
Pi: [ 0.12671939  0.87328061]
-87759.302816
rate: 0.776582065886 0.001
delta: 0.0971675855835 0.001
small change times: 0
num iteration  36
[[  9.99947090e-01   5.29103733e-05]
 [  1.53667709e-01   8.46332291e-01]]
[[ 0.10047063  0.89952937]
 [ 0.85778538  0.14221462]]
Pi: [ 0.12671985  0.87328015]
-87759.2268488
rate: 0.781815541148 0.001
delta: 0.075967128505 0.001
small change times: 0
num iteration  37
[[  9.99951456e-01   4.85441439e-05]
 [  1.53660984e-01   8.46339016e-01]]
[[ 0.10047635  0.89952365]
 [ 0.85777855  0.14222145]]
Pi: [ 0.12672022  0.87327978]
-87759.1670648
rate: 0.786973058335 0.001
delta: 0.0597840834525 0.001
small change times: 0
num iteration  38
[[  9.99955190e-01   4.48100149e-05]
 [  1.53655296e-01   8.46344704e-01]]
[[ 0.1004813   0.8995187 ]
 [ 0.85777271  0.14222729]]
Pi: [ 0.12672053  0.87327947]
-87759.1197125
rate: 0.792055225555 0.001
delta: 0.0473522957036 0.001
small change times: 0
num iteration  39
[[  9.99958403e-01   4.15970617e-05]
 [  1.53650456e-01   8.46349544e-01]]
[[ 0.10048561  0.89951439]
 [ 0.85776769  0.14223231]]
Pi: [ 0.12672079  0.87327921]
-87759.0819702
rate: 0.797052710274 0.001
delta: 0.0377422756283 0.001
small change times: 0
num iteration  40
[[  9.99961183e-01   3.88165879e-05]
 [  1.53646313e-01   8.46353687e-01]]
[[ 0.10048938  0.89951062]
 [ 0.85776335  0.14223665]]
Pi: [ 0.12672101  0.87327899]
-87759.0517027
rate: 0.801950795028 0.001
delta: 0.0302674479462 0.001
small change times: 0
num iteration  41
[[  9.99963603e-01   3.63972243e-05]
 [  1.53642745e-01   8.46357255e-01]]
[[ 0.10049271  0.89950729]
 [ 0.85775958  0.14224042]]
Pi: [ 0.12672121  0.87327879]
-87759.027285
rate: 0.806732768686 0.001
delta: 0.0244177420827 0.001
small change times: 0
num iteration  42
[[  9.99965719e-01   3.42811925e-05]
 [  1.53639656e-01   8.46360344e-01]]
[[ 0.10049564  0.89950436]
 [ 0.85775629  0.14224371]]
Pi: [ 0.12672138  0.87327862]
-87759.0074729
rate: 0.811382371584 0.001
delta: 0.0198121254798 0.001
small change times: 0
num iteration  43
[[  9.99967579e-01   3.24214368e-05]
 [  1.53636968e-01   8.46363032e-01]]
[[ 0.10049825  0.89950175]
 [ 0.8577534   0.1422466 ]]
Pi: [ 0.12672152  0.87327848]
-87758.9913085
rate: 0.815885215895 0.001
delta: 0.0161644202744 0.001
small change times: 0
num iteration  44
[[  9.99969221e-01   3.07794106e-05]
 [  1.53634616e-01   8.46365384e-01]]
[[ 0.10050057  0.89949943]
 [ 0.85775085  0.14224915]]
Pi: [ 0.12672166  0.87327834]
-87758.9780499
rate: 0.820229620209 0.001
delta: 0.0132585363026 0.001
small change times: 0
num iteration  45
[[  9.99970677e-01   2.93233585e-05]
 [  1.53632550e-01   8.46367450e-01]]
[[ 0.10050264  0.89949736]
 [ 0.8577486   0.1422514 ]]
Pi: [ 0.12672177  0.87327823]
-87758.9671195
rate: 0.82440685122 0.001
delta: 0.010930428165 0.001
small change times: 0
num iteration  46
[[  9.99971973e-01   2.80269741e-05]
 [  1.53630725e-01   8.46369275e-01]]
[[ 0.10050451  0.89949549]
 [ 0.8577466   0.1422534 ]]
Pi: [ 0.12672188  0.87327812]
-87758.9580646
rate: 0.828411221665 0.001
delta: 0.0090548893495 0.001
small change times: 0
num iteration  47
[[  9.99973132e-01   2.68683484e-05]
 [  1.53629108e-01   8.46370892e-01]]
[[ 0.10050618  0.89949382]
 [ 0.85774481  0.14225519]]
Pi: [ 0.12672197  0.87327803]
-87758.9505288
rate: 0.832239628768 0.001
delta: 0.00753583775077 0.001
small change times: 0
num iteration  48
[[  9.99974171e-01   2.58291389e-05]
 [  1.53627669e-01   8.46372331e-01]]
[[ 0.1005077   0.8994923 ]
 [ 0.85774322  0.14225678]]
Pi: [ 0.12672206  0.87327794]
-87758.9442296
rate: 0.835891417566 0.001
delta: 0.00629914210003 0.001
small change times: 0
num iteration  49
[[  9.99975106e-01   2.48939113e-05]
 [  1.53626383e-01   8.46373617e-01]]
[[ 0.10050907  0.89949093]
 [ 0.85774178  0.14225822]]
Pi: [ 0.12672213  0.87327787]
-87758.9389423
rate: 0.839367829164 0.001
delta: 0.0052872972301 0.001
small change times: 0
num iteration  50
[[  9.99975950e-01   2.40496152e-05]
 [  1.53625230e-01   8.46374770e-01]]
[[ 0.10051032  0.89948968]
 [ 0.85774048  0.14225952]]
Pi: [ 0.1267222  0.8732778]
-87758.9344869
rate: 0.842671828153 0.001
delta: 0.00445545642287 0.001
small change times: 0
num iteration  51
[[  9.99976715e-01   2.32851633e-05]
 [  1.53624193e-01   8.46375807e-01]]
[[ 0.10051146  0.89948854]
 [ 0.85773931  0.14226069]]
Pi: [ 0.12672226  0.87327774]
-87758.9307184
rate: 0.845807635994 0.001
delta: 0.0037684590643 0.001
small change times: 0
num iteration  52
[[  9.99977409e-01   2.25910934e-05]
 [  1.53623257e-01   8.46376743e-01]]
[[ 0.10051249  0.89948751]
 [ 0.85773825  0.14226175]]
Pi: [ 0.12672232  0.87327768]
-87758.9275198
rate: 0.848780260353 0.001
delta: 0.00319859366573 0.001
small change times: 0
num iteration  53
[[  9.99978041e-01   2.19592945e-05]
 [  1.53622410e-01   8.46377590e-01]]
[[ 0.10051344  0.89948656]
 [ 0.85773729  0.14226271]]
Pi: [ 0.12672237  0.87327763]
-87758.9247959
rate: 0.851595452152 0.001
delta: 0.00272390781902 0.001
small change times: 0
num iteration  54
[[  9.99978617e-01   2.13827847e-05]
 [  1.53621641e-01   8.46378359e-01]]
[[ 0.10051431  0.89948569]
 [ 0.85773641  0.14226359]]
Pi: [ 0.12672242  0.87327758]
-87758.922469
rate: 0.854259677778 0.001
delta: 0.00232692461577 0.001
small change times: 0
num iteration  55
[[  9.99979144e-01   2.08555293e-05]
 [  1.53620941e-01   8.46379059e-01]]
[[ 0.10051511  0.89948489]
 [ 0.8577356   0.1422644 ]]
Pi: [ 0.12672247  0.87327753]
-87758.9204753
rate: 0.856779300305 0.001
delta: 0.00199366084416 0.001
small change times: 0
num iteration  56
[[  9.99979628e-01   2.03722921e-05]
 [  1.53620303e-01   8.46379697e-01]]
[[ 0.10051585  0.89948415]
 [ 0.85773487  0.14226513]]
Pi: [ 0.12672251  0.87327749]
-87758.9187624
rate: 0.859160817478 0.001
delta: 0.00171287528065 0.001
small change times: 0
num iteration  57
[[  9.99980071e-01   1.99285125e-05]
 [  1.53619720e-01   8.46380280e-01]]
[[ 0.10051652  0.89948348]
 [ 0.85773419  0.14226581]]
Pi: [ 0.12672255  0.87327745]
-87758.917287
rate: 0.861411451822 0.001
delta: 0.00147549038229 0.001
small change times: 0
num iteration  58
[[  9.99980480e-01   1.95202042e-05]
 [  1.53619186e-01   8.46380814e-01]]
[[ 0.10051715  0.89948285]
 [ 0.85773357  0.14226643]]
Pi: [ 0.12672258  0.87327742]
-87758.9160128
rate: 0.863537383877 0.001
delta: 0.00127414110466 0.001
small change times: 0
num iteration  59
[[  9.99980856e-01   1.91438704e-05]
 [  1.53618695e-01   8.46381305e-01]]
[[ 0.10051773  0.89948227]
 [ 0.857733    0.142267  ]]
Pi: [ 0.12672261  0.87327739]
-87758.91491
rate: 0.865545109311 0.001
delta: 0.00110282660171 0.001
small change times: 0
num iteration  60
[[  9.99981204e-01   1.87964340e-05]
 [  1.53618244e-01   8.46381756e-01]]
[[ 0.10051826  0.89948174]
 [ 0.85773247  0.14226753]]
Pi: [ 0.12672264  0.87327736]
-87758.9139534
rate: 0.867440805133 0.001
delta: 0.000956636795308 0.001
small change times: 1
num iteration  61
[[  9.99981525e-01   1.84751781e-05]
 [  1.53617829e-01   8.46382171e-01]]
[[ 0.10051876  0.89948124]
 [ 0.85773199  0.14226801]]
Pi: [ 0.12672267  0.87327733]
-87758.9131218
rate: 0.869231306315 0.001
delta: 0.000831538651255 0.001
small change times: 2
num iteration  62
[[  9.99981822e-01   1.81776968e-05]
 [  1.53617445e-01   8.46382555e-01]]
[[ 0.10051922  0.89948078]
 [ 0.85773154  0.14226846]]
Pi: [ 0.1267227  0.8732773]
-87758.9123976
rate: 0.870921219068 0.001
delta: 0.000724204655853 0.001
small change times: 3
num iteration  63
[[  9.99982098e-01   1.79018531e-05]
 [  1.53617091e-01   8.46382909e-01]]
[[ 0.10051965  0.89948035]
 [ 0.85773112  0.14226888]]
Pi: [ 0.12672272  0.87327728]
-87758.9117657
rate: 0.872517241106 0.001
delta: 0.000631881048321 0.001
small change times: 4
num iteration  64
[[  9.99982354e-01   1.76457437e-05]
 [  1.53616763e-01   8.46383237e-01]]
[[ 0.10052005  0.89947995]
 [ 0.85773073  0.14226927]]
Pi: [ 0.12672274  0.87327726]
-87758.9112134
rate: 0.87402396014 0.001
delta: 0.00055227917619 0.001
small change times: 5
num iteration  65
[[  9.99982592e-01   1.74076685e-05]
 [  1.53616458e-01   8.46383542e-01]]
[[ 0.10052042  0.89947958]
 [ 0.85773037  0.14226963]]
Pi: [ 0.12672276  0.87327724]
-87758.91073
rate: 0.875447113453 0.001
delta: 0.000483491210616 0.001
small change times: 6
==================================================
只有EM步骤迭代
HMM content: N = 2 ,M = 2
hmm.A  [  9.99982592e-01   1.74076685e-05]  hmm.B  [ 0.10052042  0.89947958]
       [ 0.15361646  0.84638354]         [ 0.85773037  0.14226963]
hmm.pi [ 0.12672276  0.87327724]
finalprob: -87758.91073
iteration num: 66
totaltime: 61
==================================================
