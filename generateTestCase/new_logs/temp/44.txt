python my HMM
['sparkpybkt_hdfs_beta3.py', '4', '4']
BaumWelch
user_num  10000
column_num 20
beta3
num iteration  0
[[ 0.61894862  0.38105138]
 [ 0.14711996  0.85288004]]
[[ 0.63259672  0.36740328]
 [ 0.15594287  0.84405713]]
Pi: [ 0.66925711  0.33074289]
-118529.816442
num iteration  0
[[ 0.69483979  0.30516021]
 [ 0.10009398  0.89990602]]
[[ 0.73627325  0.26372675]
 [ 0.10168475  0.89831525]]
Pi: [ 0.83234294  0.16765706]
-108043.353665
rate: 1.0486462777e+73 0.001
delta: 10486.462777 0.001
small change times: 0
num iteration  1
[[ 0.75702313  0.24297687]
 [ 0.05917317  0.94082683]]
[[ 0.8084072   0.1915928 ]
 [ 0.07350455  0.92649545]]
Pi: [ 0.89733233  0.10266767]
-97269.0552212
rate: 1.02744830863 0.001
delta: 10774.2984437 0.001
small change times: 0
num iteration  2
[[ 0.79021326  0.20978674]
 [ 0.03647835  0.96352165]]
[[ 0.83948792  0.16051208]
 [ 0.07091775  0.92908225]]
Pi: [ 0.90847183  0.09152817]
-91712.8881965
rate: 0.515687128374 0.001
delta: 5556.16702469 0.001
small change times: 0
num iteration  3
[[ 0.80895929  0.19104071]
 [ 0.02348838  0.97651162]]
[[ 0.85108439  0.14891561]
 [ 0.07746274  0.92253726]]
Pi: [ 0.90305977  0.09694023]
-89989.2081257
rate: 0.310228267644 0.001
delta: 1723.68007081 0.001
small change times: 0
num iteration  4
[[ 0.82144983  0.17855017]
 [ 0.01512445  0.98487555]]
[[ 0.85612879  0.14387121]
 [ 0.08452486  0.91547514]]
Pi: [ 0.89474724  0.10525276]
-89110.8598544
rate: 0.509577320115 0.001
delta: 878.34827122 0.001
small change times: 0
num iteration  5
[[ 0.8299551   0.1700449 ]
 [ 0.00972084  0.99027916]]
[[ 0.85848188  0.14151812]
 [ 0.08986121  0.91013879]]
Pi: [ 0.88751307  0.11248693]
-88553.9339529
rate: 0.634060451599 0.001
delta: 556.925901511 0.001
small change times: 0
num iteration  6
[[ 0.83556507  0.16443493]
 [ 0.00631376  0.99368624]]
[[ 0.85944062  0.14055938]
 [ 0.09345643  0.90654357]]
Pi: [ 0.88221692  0.11778308]
-88220.0171359
rate: 0.599571354406 0.001
delta: 333.916817073 0.001
small change times: 0
num iteration  7
[[ 0.83917634  0.16082366]
 [ 0.00418674  0.99581326]]
[[ 0.85967077  0.14032923]
 [ 0.09578325  0.90421675]]
Pi: [ 0.87869625  0.12130375]
-88029.0366552
rate: 0.571940288418 0.001
delta: 190.980480664 0.001
small change times: 0
num iteration  8
[[ 0.84148872  0.15851128]
 [ 0.00284836  0.99715164]]
[[ 0.85956353  0.14043647]
 [ 0.09727929  0.90272071]]
Pi: [ 0.87649758  0.12350242]
-87921.1017033
rate: 0.565162216997 0.001
delta: 107.934951855 0.001
small change times: 0
num iteration  9
[[ 0.84298299  0.15701701]
 [ 0.00199021  0.99800979]]
[[ 0.85933153  0.14066847]
 [ 0.09825034  0.90174966]]
Pi: [ 0.87517676  0.12482324]
-87859.2882241
rate: 0.572691960763 0.001
delta: 61.8134792128 0.001
small change times: 0
num iteration  10
[[ 0.84396549  0.15603451]
 [ 0.00142691  0.99857309]]
[[ 0.85907689  0.14092311]
 [ 0.09889158  0.90110842]]
Pi: [ 0.87439971  0.12560029]
-87822.9650272
rate: 0.587625827546 0.001
delta: 36.323196876 0.001
small change times: 0
num iteration  11
[[ 0.84462545  0.15537455]
 [ 0.00104792  0.99895208]]
[[ 0.85884193  0.14115807]
 [ 0.09932402  0.90067598]]
Pi: [ 0.87394616  0.12605384]
-87800.9749604
rate: 0.605400093743 0.001
delta: 21.9900667937 0.001
small change times: 0
num iteration  12
[[  8.45078944e-01   1.54921056e-01]
 [  7.86733067e-04   9.99213267e-01]]
[[ 0.85864021  0.14135979]
 [ 0.09962224  0.90037776]]
Pi: [ 0.87368113  0.12631887]
-87787.2595616
rate: 0.62370883296 0.001
delta: 13.7153988966 0.001
small change times: 0
num iteration  13
[[  8.45397637e-01   1.54602363e-01]
 [  6.02595839e-04   9.99397404e-01]]
[[ 0.85847289  0.14152711]
 [ 0.09983251  0.90016749]]
Pi: [ 0.87352516  0.12647484]
-87778.4605248
rate: 0.641544354969 0.001
delta: 8.79903673829 0.001
small change times: 0
num iteration  14
[[  8.45626371e-01   1.54373629e-01]
 [  4.70029579e-04   9.99529970e-01]]
[[ 0.85833647  0.14166353]
 [ 0.09998396  0.90001604]]
Pi: [ 0.87343234  0.12656766]
-87772.6669137
rate: 0.658436976581 0.001
delta: 5.79361114679 0.001
small change times: 0
num iteration  15
[[  8.45793714e-01   1.54206286e-01]
 [  3.72752338e-04   9.99627248e-01]]
[[ 0.85822619  0.14177381]
 [ 0.10009524  0.89990476]]
Pi: [ 0.87337637  0.12662363]
-87768.7613701
rate: 0.674112131845 0.001
delta: 3.90554356124 0.001
small change times: 0
num iteration  16
[[  8.45918247e-01   1.54081753e-01]
 [  3.00130635e-04   9.99699869e-01]]
[[ 0.85813735  0.14186265]
 [ 0.10017851  0.89982149]]
Pi: [ 0.87334211  0.12665789]
-87766.0727947
rate: 0.688399796843 0.001
delta: 2.68857539412 0.001
small change times: 0
num iteration  17
[[  8.46012324e-01   1.53987676e-01]
 [  2.45070053e-04   9.99754930e-01]]
[[ 0.85806586  0.14193414]
 [ 0.10024188  0.89975812]]
Pi: [ 0.87332079  0.12667921]
-87764.1874925
rate: 0.701227213438 0.001
delta: 1.88530223173 0.001
small change times: 0
num iteration  18
[[  8.46084342e-01   1.53915658e-01]
 [  2.02739317e-04   9.99797261e-01]]
[[ 0.85800826  0.14199174]
 [ 0.10029085  0.89970915]]
Pi: [ 0.87330729  0.12669271]
-87762.8439958
rate: 0.712616102121 0.001
delta: 1.3434967277 0.001
small change times: 0
num iteration  19
[[  8.46140125e-01   1.53859875e-01]
 [  1.69784100e-04   9.99830216e-01]]
[[ 0.85796176  0.14203824]
 [ 0.10032922  0.89967078]]
Pi: [ 0.87329858  0.12670142]
-87761.8730949
rate: 0.722667081798 0.001
delta: 0.970900859611 0.001
small change times: 0
num iteration  20
[[  8.46183789e-01   1.53816211e-01]
 [  1.43833312e-04   9.99856167e-01]]
[[ 0.85792408  0.14207592]
 [ 0.10035967  0.89964033]]
Pi: [ 0.87329284  0.12670716]
-87761.1628458
rate: 0.731536123504 0.001
delta: 0.710249051146 0.001
small change times: 0
num iteration  21
[[  8.46218296e-01   1.53781704e-01]
 [  1.23183062e-04   9.99876817e-01]]
[[ 0.85789344  0.14210656]
 [ 0.10038413  0.89961587]]
Pi: [ 0.87328898  0.12671102]
-87760.6376807
rate: 0.739409905746 0.001
delta: 0.525165183964 0.001
small change times: 0
num iteration  22
[[  8.46245808e-01   1.53754192e-01]
 [  1.06590498e-04   9.99893410e-01]]
[[ 0.85786841  0.14213159]
 [ 0.10040399  0.89959601]]
Pi: [ 0.87328632  0.12671368]
-87760.2456533
rate: 0.746483893873 0.001
delta: 0.392027351452 0.001
small change times: 0
num iteration  23
[[  8.46267924e-01   1.53732076e-01]
 [  9.31367963e-05   9.99906863e-01]]
[[ 0.85784787  0.14215213]
 [ 0.10042027  0.89957973]]
Pi: [ 0.87328445  0.12671555]
-87759.9504784
rate: 0.752944669539 0.001
delta: 0.29517490459 0.001
small change times: 0
num iteration  24
[[  8.46285843e-01   1.53714157e-01]
 [  8.21344622e-05   9.99917866e-01]]
[[ 0.85783091  0.14216909]
 [ 0.10043374  0.89956626]]
Pi: [ 0.87328309  0.12671691]
-87759.7264533
rate: 0.75895705959 0.001
delta: 0.224025077652 0.001
small change times: 0
num iteration  25
[[  8.46300470e-01   1.53699530e-01]
 [  7.30635177e-05   9.99926936e-01]]
[[ 0.85781684  0.14218316]
 [ 0.10044499  0.89955501]]
Pi: [ 0.87328208  0.12671792]
-87759.5551511
rate: 0.764656254639 0.001
delta: 0.171302176823 0.001
small change times: 0
num iteration  26
[[  8.46312496e-01   1.53687504e-01]
 [  6.55268585e-05   9.99934473e-01]]
[[ 0.8578051   0.1421949 ]
 [ 0.10045446  0.89954554]]
Pi: [ 0.87328132  0.12671868]
-87759.4232237
rate: 0.770144679678 0.001
delta: 0.131927460097 0.001
small change times: 0
num iteration  27
[[  8.46322454e-01   1.53677546e-01]
 [  5.92185446e-05   9.99940781e-01]]
[[ 0.85779525  0.14220475]
 [ 0.10046249  0.89953751]]
Pi: [ 0.87328072  0.12671928]
-87759.3209149
rate: 0.775492897365 0.001
delta: 0.102308808273 0.001
small change times: 0
num iteration  28
[[  8.46330755e-01   1.53669245e-01]
 [  5.39009654e-05   9.99946099e-01]]
[[ 0.85778693  0.14221307]
 [ 0.10046934  0.89953066]]
Pi: [ 0.87328024  0.12671976]
-87759.241038
rate: 0.78074339226 0.001
delta: 0.0798769260291 0.001
small change times: 0
num iteration  29
[[  8.46337722e-01   1.53662278e-01]
 [  4.93881903e-05   9.99950612e-01]]
[[ 0.85777987  0.14222013]
 [ 0.10047524  0.89952476]]
Pi: [ 0.87327985  0.12672015]
-87759.1782614
rate: 0.785916100615 0.001
delta: 0.0627765622339 0.001
small change times: 0
num iteration  30
[[  8.46343606e-01   1.53656394e-01]
 [  4.55336969e-05   9.99954466e-01]]
[[ 0.85777384  0.14222616]
 [ 0.10048033  0.89951967]]
Pi: [ 0.87327953  0.12672047]
-87759.1286042
rate: 0.791014305416 0.001
delta: 0.0496571587719 0.001
small change times: 0
num iteration  31
[[  8.46348608e-01   1.53651392e-01]
 [  4.22212358e-05   9.99957779e-01]]
[[ 0.85776866  0.14223134]
 [ 0.10048477  0.89951523]]
Pi: [ 0.87327926  0.12672074]
-87759.0890756
rate: 0.796030332272 0.001
delta: 0.0395286045969 0.001
small change times: 0
num iteration  32
[[  8.46352884e-01   1.53647116e-01]
 [  3.93579750e-05   9.99960642e-01]]
[[ 0.85776419  0.14223581]
 [ 0.10048865  0.89951135]]
Pi: [ 0.87327903  0.12672097]
-87759.0574152
rate: 0.800950236722 0.001
delta: 0.0316604452091 0.001
small change times: 0
num iteration  33
[[  8.46356562e-01   1.53643438e-01]
 [  3.68693134e-05   9.99963131e-01]]
[[ 0.85776031  0.14223969]
 [ 0.10049205  0.89950795]]
Pi: [ 0.87327883  0.12672117]
-87759.0319045
rate: 0.805757522002 0.001
delta: 0.0255106418772 0.001
small change times: 0
num iteration  34
[[  8.46359743e-01   1.53640257e-01]
 [  3.46949309e-05   9.99965305e-01]]
[[ 0.85775693  0.14224307]
 [ 0.10049506  0.89950494]]
Pi: [ 0.87327866  0.12672134]
-87759.0112298
rate: 0.810435664932 0.001
delta: 0.0206747340126 0.001
small change times: 0
num iteration  35
[[  8.46362508e-01   1.53637492e-01]
 [  3.27857619e-05   9.99967214e-01]]
[[ 0.85775396  0.14224604]
 [ 0.10049773  0.89950227]]
Pi: [ 0.8732785  0.1267215]
-87758.9943805
rate: 0.814969797124 0.001
delta: 0.0168492837838 0.001
small change times: 0
num iteration  36
[[  8.46364924e-01   1.53635076e-01]
 [  3.11016611e-05   9.99968898e-01]]
[[ 0.85775135  0.14224865]
 [ 0.10050011  0.89949989]]
Pi: [ 0.87327837  0.12672163]
-87758.9805751
rate: 0.819347657584 0.001
delta: 0.0138054212002 0.001
small change times: 0
num iteration  37
[[  8.46367046e-01   1.53632954e-01]
 [  2.96095939e-05   9.99970390e-01]]
[[ 0.85774904  0.14225096]
 [ 0.10050223  0.89949777]]
Pi: [ 0.87327825  0.12672175]
-87758.9692055
rate: 0.823559935783 0.001
delta: 0.0113695917971 0.001
small change times: 0
num iteration  38
[[  8.46368917e-01   1.53631083e-01]
 [  2.82822255e-05   9.99971718e-01]]
[[ 0.85774699  0.14225301]
 [ 0.10050414  0.89949586]]
Pi: [ 0.87327814  0.12672186]
-87758.959796
rate: 0.827600255452 0.001
delta: 0.00940947707568 0.001
small change times: 0
num iteration  39
[[  8.46370574e-01   1.53629426e-01]
 [  2.70968150e-05   9.99972903e-01]]
[[ 0.85774517  0.14225483]
 [ 0.10050585  0.89949415]]
Pi: [ 0.87327805  0.12672195]
-87758.9519724
rate: 0.831465066439 0.001
delta: 0.00782365148189 0.001
small change times: 0
num iteration  40
[[  8.46372048e-01   1.53627952e-01]
 [  2.60343436e-05   9.99973966e-01]]
[[ 0.85774353  0.14225647]
 [ 0.1005074   0.8994926 ]]
Pi: [ 0.87327796  0.12672204]
-87758.9454384
rate: 0.835153145903 0.001
delta: 0.00653394714755 0.001
small change times: 0
num iteration  41
[[  8.46373364e-01   1.53626636e-01]
 [  2.50788247e-05   9.99974921e-01]]
[[ 0.85774206  0.14225794]
 [ 0.1005088   0.8994912 ]]
Pi: [ 0.87327788  0.12672212]
-87758.9399586
rate: 0.838665601831 0.001
delta: 0.00547979671683 0.001
small change times: 0
num iteration  42
[[  8.46374543e-01   1.53625457e-01]
 [  2.42167538e-05   9.99975783e-01]]
[[ 0.85774074  0.14225926]
 [ 0.10051007  0.89948993]]
Pi: [ 0.87327781  0.12672219]
-87758.9353446
rate: 0.842004800064 0.001
delta: 0.00461401513894 0.001
small change times: 0
num iteration  43
[[  8.46375602e-01   1.53624398e-01]
 [  2.34366691e-05   9.99976563e-01]]
[[ 0.85773955  0.14226045]
 [ 0.10051123  0.89948877]]
Pi: [ 0.87327775  0.12672225]
-87758.931445
rate: 0.845174860305 0.001
delta: 0.0038996496005 0.001
small change times: 0
num iteration  44
[[  8.46376558e-01   1.53623442e-01]
 [  2.27287979e-05   9.99977271e-01]]
[[ 0.85773846  0.14226154]
 [ 0.10051229  0.89948771]]
Pi: [ 0.87327769  0.12672231]
-87758.9281374
rate: 0.848180664305 0.001
delta: 0.00330760738871 0.001
small change times: 0
num iteration  45
[[  8.46377423e-01   1.53622577e-01]
 [  2.20847704e-05   9.99977915e-01]]
[[ 0.85773748  0.14226252]
 [ 0.10051325  0.89948675]]
Pi: [ 0.87327764  0.12672236]
-87758.9253225
rate: 0.851027801949 0.001
delta: 0.00281486584572 0.001
small change times: 0
num iteration  46
[[  8.46378207e-01   1.53621793e-01]
 [  2.14973879e-05   9.99978503e-01]]
[[ 0.85773658  0.14226342]
 [ 0.10051414  0.89948586]]
Pi: [ 0.87327759  0.12672241]
-87758.9229194
rate: 0.853722713445 0.001
delta: 0.00240311490779 0.001
small change times: 0
num iteration  47
[[  8.46378920e-01   1.53621080e-01]
 [  2.09604339e-05   9.99979040e-01]]
[[ 0.85773576  0.14226424]
 [ 0.10051495  0.89948505]]
Pi: [ 0.87327754  0.12672246]
-87758.9208617
rate: 0.856271344551 0.001
delta: 0.00205771843321 0.001
small change times: 0
num iteration  48
[[  8.46379570e-01   1.53620430e-01]
 [  2.04685182e-05   9.99979531e-01]]
[[ 0.85773501  0.14226499]
 [ 0.1005157   0.8994843 ]]
Pi: [ 0.8732775  0.1267225]
-87758.9190947
rate: 0.858681115947 0.001
delta: 0.00176692396053 0.001
small change times: 0
num iteration  49
[[  8.46380164e-01   1.53619836e-01]
 [  2.00169501e-05   9.99979983e-01]]
[[ 0.85773433  0.14226567]
 [ 0.10051639  0.89948361]]
Pi: [ 0.87327746  0.12672254]
-87758.9175735
rate: 0.860958026665 0.001
delta: 0.00152124736633 0.001
small change times: 0
num iteration  50
[[  8.46380708e-01   1.53619292e-01]
 [  1.96016322e-05   9.99980398e-01]]
[[ 0.8577337   0.1422663 ]
 [ 0.10051702  0.89948298]]
Pi: [ 0.87327743  0.12672257]
-87758.9162605
rate: 0.863108975749 0.001
delta: 0.00131300225621 0.001
small change times: 0
num iteration  51
[[  8.46381207e-01   1.53618793e-01]
 [  1.92189731e-05   9.99980781e-01]]
[[ 0.85773312  0.14226688]
 [ 0.10051761  0.89948239]]
Pi: [ 0.87327739  0.12672261]
-87758.9151246
rate: 0.865140540227 0.001
delta: 0.00113593148126 0.001
small change times: 0
num iteration  52
[[  8.46381666e-01   1.53618334e-01]
 [  1.88658143e-05   9.99981134e-01]]
[[ 0.85773258  0.14226742]
 [ 0.10051816  0.89948184]]
Pi: [ 0.87327736  0.12672264]
-87758.9141396
rate: 0.867059313661 0.001
delta: 0.000984919970506 0.001
small change times: 1
num iteration  53
[[  8.46382088e-01   1.53617912e-01]
 [  1.85393690e-05   9.99981461e-01]]
[[ 0.85773209  0.14226791]
 [ 0.10051866  0.89948134]]
Pi: [ 0.87327734  0.12672266]
-87758.9132839
rate: 0.86887023712 0.001
delta: 0.000855767648318 0.001
small change times: 2
num iteration  54
[[  8.46382478e-01   1.53617522e-01]
 [  1.82371709e-05   9.99981763e-01]]
[[ 0.85773163  0.14226837]
 [ 0.10051913  0.89948087]]
Pi: [ 0.87327731  0.12672269]
-87758.9125389
rate: 0.87058114041 0.001
delta: 0.000745015175198 0.001
small change times: 3
num iteration  55
[[  8.46382838e-01   1.53617162e-01]
 [  1.79570306e-05   9.99982043e-01]]
[[ 0.8577312   0.1422688 ]
 [ 0.10051956  0.89948044]]
Pi: [ 0.87327729  0.12672271]
-87758.9118891
rate: 0.872195514847 0.001
delta: 0.000649798894301 0.001
small change times: 4
num iteration  56
[[  8.46383172e-01   1.53616828e-01]
 [  1.76969993e-05   9.99982303e-01]]
[[ 0.85773081  0.14226919]
 [ 0.10051997  0.89948003]]
Pi: [ 0.87327726  0.12672274]
-87758.9113213
rate: 0.873720804303 0.001
delta: 0.000567742812564 0.001
small change times: 5
num iteration  57
[[  8.46383481e-01   1.53616519e-01]
 [  1.74553373e-05   9.99982545e-01]]
[[ 0.85773045  0.14226955]
 [ 0.10052035  0.89947965]]
Pi: [ 0.87327724  0.12672276]
-87758.9108245
rate: 0.875160031443 0.001
delta: 0.000496865817695 0.001
small change times: 6
==================================================
只有EM步骤迭代
HMM content: N = 2 ,M = 2
hmm.A  [ 0.84638348  0.15361652]  hmm.B  [ 0.85773045  0.14226955]
       [  1.74553373e-05   9.99982545e-01]         [ 0.10052035  0.89947965]
hmm.pi [ 0.87327724  0.12672276]
finalprob: -87758.9108245
iteration num: 58
totaltime: 58
==================================================
