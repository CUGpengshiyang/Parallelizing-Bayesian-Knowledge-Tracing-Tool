python my HMM
['sparkpybkt_hdfs_beta3.py', '7', '5']
BaumWelch
user_num  10000
column_num 20
beta3
num iteration  0
[[ 0.32463857  0.67536143]
 [ 0.18777351  0.81222649]]
[[ 0.54190507  0.45809493]
 [ 0.23304046  0.76695954]]
Pi: [ 0.62157337  0.37842663]
-121396.92696
num iteration  0
[[ 0.36949772  0.63050228]
 [ 0.17145391  0.82854609]]
[[ 0.60255413  0.39744587]
 [ 0.21058491  0.78941509]]
Pi: [ 0.74373577  0.25626423]
-119736.931812
rate: 1.65999514851e+72 0.001
delta: 1659.99514851 0.001
small change times: 0
num iteration  1
[[ 0.44917154  0.55082846]
 [ 0.14804148  0.85195852]]
[[ 0.68015094  0.31984906]
 [ 0.17779299  0.82220701]]
Pi: [ 0.844044  0.155956]
-116767.103905
rate: 1.78905818445 0.001
delta: 2969.8279066 0.001
small change times: 0
num iteration  2
[[ 0.57111479  0.42888521]
 [ 0.1138715   0.8861285 ]]
[[ 0.76634048  0.23365952]
 [ 0.13171768  0.86828232]]
Pi: [ 0.90693141  0.09306859]
-111022.807943
rate: 1.93421846094 0.001
delta: 5744.29596275 0.001
small change times: 0
num iteration  3
[[ 0.68943538  0.31056462]
 [ 0.07386399  0.92613601]]
[[ 0.83143291  0.16856709]
 [ 0.08948025  0.91051975]]
Pi: [ 0.93098131  0.06901869]
-101427.207262
rate: 1.67045722281 0.001
delta: 9595.60068095 0.001
small change times: 0
num iteration  4
[[ 0.75668669  0.24331331]
 [ 0.04586354  0.95413646]]
[[ 0.85763577  0.14236423]
 [ 0.07445954  0.92554046]]
Pi: [ 0.92629036  0.07370964]
-93486.6076869
rate: 0.827525012633 0.001
delta: 7940.59957472 0.001
small change times: 0
num iteration  5
[[ 0.79089352  0.20910648]
 [ 0.02976975  0.97023025]]
[[ 0.86280266  0.13719734]
 [ 0.07639659  0.92360341]]
Pi: [ 0.91076525  0.08923475]
-90665.6398408
rate: 0.355258796207 0.001
delta: 2820.96784608 0.001
small change times: 0
num iteration  6
[[ 0.81116576  0.18883424]
 [ 0.01940559  0.98059441]]
[[ 0.86280205  0.13719795]
 [ 0.08246435  0.91753565]]
Pi: [ 0.89735703  0.10264297]
-89529.2897256
rate: 0.40282278184 0.001
delta: 1136.35011524 0.001
small change times: 0
num iteration  7
[[ 0.82399021  0.17600979]
 [ 0.01252264  0.98747736]]
[[ 0.86209127  0.13790873]
 [ 0.08801071  0.91198929]]
Pi: [ 0.88843712  0.11156288]
-88823.7026505
rate: 0.620924014188 0.001
delta: 705.587075077 0.001
small change times: 0
num iteration  8
[[ 0.8320676   0.1679324 ]
 [ 0.00808657  0.99191343]]
[[ 0.86138629  0.13861371]
 [ 0.09207209  0.90792791]]
Pi: [ 0.88274193  0.11725807]
-88383.2716996
rate: 0.624204958504 0.001
delta: 440.43095092 0.001
small change times: 0
num iteration  9
[[ 0.83708939  0.16291061]
 [ 0.00529741  0.99470259]]
[[ 0.86075398  0.13924602]
 [ 0.09481342  0.90518658]]
Pi: [ 0.87911456  0.12088544]
-88123.6898801
rate: 0.589381420446 0.001
delta: 259.581819462 0.001
small change times: 0
num iteration  10
[[ 0.8402105   0.1597895 ]
 [ 0.00355066  0.99644934]]
[[ 0.8602008   0.1397992 ]
 [ 0.09661431  0.90338569]]
Pi: [ 0.87683589  0.12316411]
-87975.3874927
rate: 0.571312689596 0.001
delta: 148.302387447 0.001
small change times: 0
num iteration  11
[[ 0.84217585  0.15782415]
 [ 0.0024431   0.9975569 ]]
[[ 0.85973152  0.14026848]
 [ 0.09779559  0.90220441]]
Pi: [ 0.87543275  0.12456725]
-87890.7979473
rate: 0.5703855945 0.001
delta: 84.5895454296 0.001
small change times: 0
num iteration  12
[[ 0.84343982  0.15656018]
 [ 0.00172595  0.99827405]]
[[ 0.85934428  0.14065572]
 [ 0.09857857  0.90142143]]
Pi: [ 0.87458242  0.12541758]
-87841.6920084
rate: 0.580520188549 0.001
delta: 49.105938862 0.001
small change times: 0
num iteration  13
[[ 0.84427291  0.15572709]
 [ 0.00125028  0.99874972]]
[[ 0.85903058  0.14096942]
 [ 0.09910603  0.90089397]]
Pi: [ 0.87407142  0.12592858]
-87812.4191226
rate: 0.596117017076 0.001
delta: 29.2728857951 0.001
small change times: 0
num iteration  14
[[  8.44836074e-01   1.55163926e-01]
 [  9.26956780e-04   9.99073043e-01]]
[[ 0.85877896  0.14122104]
 [ 0.09946817  0.90053183]]
Pi: [ 0.87376481  0.12623519]
-87794.4540001
rate: 0.613712042698 0.001
delta: 17.965122537 0.001
small change times: 0
num iteration  15
[[  8.45226214e-01   1.54773786e-01]
 [  7.01952000e-04   9.99298048e-01]]
[[ 0.85857804  0.14142196]
 [ 0.09972186  0.90027814]]
Pi: [ 0.87358017  0.12641983]
-87783.1076364
rate: 0.631577304085 0.001
delta: 11.3463636595 0.001
small change times: 0
num iteration  16
[[  8.45502743e-01   1.54497257e-01]
 [  5.41887292e-04   9.99458113e-01]]
[[ 0.85841779  0.14158221]
 [ 0.09990316  0.90009684]]
Pi: [ 0.8734682  0.1265318]
-87775.7450362
rate: 0.648895136983 0.001
delta: 7.36260020106 0.001
small change times: 0
num iteration  17
[[  8.45702850e-01   1.54297150e-01]
 [  4.25699202e-04   9.99574301e-01]]
[[ 0.85828994  0.14171006]
 [ 0.10003525  0.89996475]]
Pi: [ 0.87339966  0.12660034]
-87770.8472425
rate: 0.665226085537 0.001
delta: 4.89779371112 0.001
small change times: 0
num iteration  18
[[  8.45850350e-01   1.54149650e-01]
 [  3.39803769e-04   9.99660196e-01]]
[[ 0.85818781  0.14181219]
 [ 0.10013327  0.89986673]]
Pi: [ 0.87335724  0.12664276]
-87767.5152765
rate: 0.680299377751 0.001
delta: 3.33196601403 0.001
small change times: 0
num iteration  19
[[  8.45960848e-01   1.54039152e-01]
 [  2.75248905e-04   9.99724751e-01]]
[[ 0.85810606  0.14189394]
 [ 0.10020724  0.89979276]]
Pi: [ 0.87333066  0.12666934]
-87765.203016
rate: 0.693962807855 0.001
delta: 2.31226049077 0.001
small change times: 0
num iteration  20
[[  8.46044815e-01   1.53955185e-01]
 [  2.26009622e-04   9.99773990e-01]]
[[ 0.85804047  0.14195953]
 [ 0.10026395  0.89973605]]
Pi: [ 0.87331378  0.12668622]
-87763.5701595
rate: 0.706173248063 0.001
delta: 1.63285650114 0.001
small change times: 0
num iteration  21
[[  8.46109426e-01   1.53890574e-01]
 [  1.87948863e-04   9.99812051e-01]]
[[ 0.85798769  0.14201231]
 [ 0.10030806  0.89969194]]
Pi: [ 0.8733029  0.1266971]
-87762.3994293
rate: 0.716982906361 0.001
delta: 1.17073019985 0.001
small change times: 0
num iteration  22
[[  8.46159702e-01   1.53840298e-01]
 [  1.58172070e-04   9.99841828e-01]]
[[ 0.85794507  0.14205493]
 [ 0.10034283  0.89965717]]
Pi: [ 0.87329575  0.12670425]
-87761.5488746
rate: 0.726516369848 0.001
delta: 0.850554654869 0.001
small change times: 0
num iteration  23
[[  8.46199220e-01   1.53800780e-01]
 [  1.34618602e-04   9.99865381e-01]]
[[ 0.85791051  0.14208949]
 [ 0.10037056  0.89962944]]
Pi: [ 0.87329098  0.12670902]
-87760.9237643
rate: 0.734944387981 0.001
delta: 0.625110370267 0.001
small change times: 0
num iteration  24
[[  8.46230569e-01   1.53769431e-01]
 [  1.15798088e-04   9.99884202e-01]]
[[ 0.85788236  0.14211764]
 [ 0.10039294  0.89960706]]
Pi: [ 0.87328772  0.12671228]
-87760.4596452
rate: 0.742459352651 0.001
delta: 0.464119040844 0.001
small change times: 0
num iteration  25
[[  8.46255652e-01   1.53744348e-01]
 [  1.00617091e-04   9.99899383e-01]]
[[ 0.85785932  0.14214068]
 [ 0.10041119  0.89958881]]
Pi: [ 0.87328545  0.12671455]
-87760.1119018
rate: 0.74925472188 0.001
delta: 0.347743382867 0.001
small change times: 0
num iteration  26
[[  8.46275883e-01   1.53724117e-01]
 [  8.82630306e-05   9.99911737e-01]]
[[ 0.85784038  0.14215962]
 [ 0.10042621  0.89957379]]
Pi: [ 0.87328382  0.12671618]
-87759.8491785
rate: 0.75550917552 0.001
delta: 0.262723316482 0.001
small change times: 0
num iteration  27
[[  8.46292326e-01   1.53707674e-01]
 [  7.81250683e-05   9.99921875e-01]]
[[ 0.8578247   0.1421753 ]
 [ 0.10043869  0.89956131]]
Pi: [ 0.87328263  0.12671737]
-87759.6491474
rate: 0.761375776564 0.001
delta: 0.200031169108 0.001
small change times: 0
num iteration  28
[[  8.46305790e-01   1.53694210e-01]
 [  6.97392709e-05   9.99930261e-01]]
[[ 0.85781167  0.14218833]
 [ 0.10044915  0.89955085]]
Pi: [ 0.87328174  0.12671826]
-87759.4957282
rate: 0.766976112197 0.001
delta: 0.153419128401 0.001
small change times: 0
num iteration  29
[[  8.46316893e-01   1.53683107e-01]
 [  6.27499947e-05   9.99937250e-01]]
[[ 0.85780077  0.14219923]
 [ 0.10045798  0.89954202]]
Pi: [ 0.87328105  0.12671895]
-87759.3772274
rate: 0.772398942738 0.001
delta: 0.118500772573 0.001
small change times: 0
num iteration  30
[[  8.46326112e-01   1.53673888e-01]
 [  5.68822945e-05   9.99943118e-01]]
[[ 0.8577916   0.1422084 ]
 [ 0.10046549  0.89953451]]
Pi: [ 0.8732805  0.1267195]
-87759.2850691
rate: 0.777702490016 0.001
delta: 0.0921583458985 0.001
small change times: 0
num iteration  31
[[  8.46333820e-01   1.53666180e-01]
 [  5.19219478e-05   9.99948078e-01]]
[[ 0.85778383  0.14221617]
 [ 0.10047192  0.89952808]]
Pi: [ 0.87328007  0.12671993]
-87759.2129166
rate: 0.782919072249 0.001
delta: 0.0721525266708 0.001
small change times: 0
num iteration  32
[[  8.46340306e-01   1.53659694e-01]
 [  4.77008209e-05   9.99952299e-01]]
[[ 0.85777723  0.14222277]
 [ 0.10047746  0.89952254]]
Pi: [ 0.87327971  0.12672029]
-87759.156056
rate: 0.788060918887 0.001
delta: 0.0568605864682 0.001
small change times: 0
num iteration  33
[[  8.46345799e-01   1.53654201e-01]
 [  4.40860360e-05   9.99955914e-01]]
[[ 0.85777158  0.14222842]
 [ 0.10048227  0.89951773]]
Pi: [ 0.87327941  0.12672059]
-87759.1109584
rate: 0.7931260962 0.001
delta: 0.0450976149732 0.001
small change times: 0
num iteration  34
[[  8.46350479e-01   1.53649521e-01]
 [  4.09718796e-05   9.99959028e-01]]
[[ 0.85776671  0.14223329]
 [ 0.10048646  0.89951354]]
Pi: [ 0.87327916  0.12672084]
-87759.0749658
rate: 0.798103777295 0.001
delta: 0.0359925768571 0.001
small change times: 0
num iteration  35
[[  8.46354491e-01   1.53645509e-01]
 [  3.82737077e-05   9.99961726e-01]]
[[ 0.8577625   0.1422375 ]
 [ 0.10049013  0.89950987]]
Pi: [ 0.87327894  0.12672106]
-87759.0460645
rate: 0.802978557558 0.001
delta: 0.0289012674475 0.001
small change times: 0
num iteration  36
[[  8.46357950e-01   1.53642050e-01]
 [  3.59233227e-05   9.99964077e-01]]
[[ 0.85775884  0.14224116]
 [ 0.10049336  0.89950664]]
Pi: [ 0.87327875  0.12672125]
-87759.02272
rate: 0.807733704275 0.001
delta: 0.0233445278136 0.001
small change times: 0
num iteration  37
[[  8.46360947e-01   1.53639053e-01]
 [  3.38654428e-05   9.99966135e-01]]
[[ 0.85775564  0.14224436]
 [ 0.10049622  0.89950378]]
Pi: [ 0.87327859  0.12672141]
-87759.003756
rate: 0.812353184132 0.001
delta: 0.0189640015014 0.001
small change times: 0
num iteration  38
[[  8.46363559e-01   1.53636441e-01]
 [  3.20549895e-05   9.99967945e-01]]
[[ 0.85775283  0.14224717]
 [ 0.10049876  0.89950124]]
Pi: [ 0.87327845  0.12672155]
-87758.9882658
rate: 0.816823205125 0.001
delta: 0.0154902364884 0.001
small change times: 0
num iteration  39
[[  8.46365846e-01   1.53634154e-01]
 [  3.04549907e-05   9.99969545e-01]]
[[ 0.85775035  0.14224965]
 [ 0.10050103  0.89949897]]
Pi: [ 0.87327832  0.12672168]
-87758.9755462
rate: 0.821132637728 0.001
delta: 0.0127195387468 0.001
small change times: 0
num iteration  40
[[  8.46367858e-01   1.53632142e-01]
 [  2.90349517e-05   9.99970965e-01]]
[[ 0.85774816  0.14225184]
 [ 0.10050306  0.89949694]]
Pi: [ 0.8732782  0.1267218]
-87758.9650491
rate: 0.825273526693 0.001
delta: 0.0104970985994 0.001
small change times: 0
num iteration  41
[[  8.46369635e-01   1.53630365e-01]
 [  2.77695816e-05   9.99972230e-01]]
[[ 0.8577462   0.1422538 ]
 [ 0.10050488  0.89949512]]
Pi: [ 0.8732781  0.1267219]
-87758.9563445
rate: 0.8292405986 0.001
delta: 0.00870462032617 0.001
small change times: 0
num iteration  42
[[  8.46371212e-01   1.53628788e-01]
 [  2.66377933e-05   9.99973362e-01]]
[[ 0.85774446  0.14225554]
 [ 0.10050652  0.89949348]]
Pi: [ 0.87327801  0.12672199]
-87758.9490933
rate: 0.833031421 0.001
delta: 0.00725122223957 0.001
small change times: 0
num iteration  43
[[  8.46372617e-01   1.53627383e-01]
 [  2.56219132e-05   9.99974378e-01]]
[[ 0.8577429  0.1422571]
 [ 0.100508   0.899492 ]]
Pi: [ 0.87327793  0.12672207]
-87758.9430266
rate: 0.836645682007 0.001
delta: 0.00606670377601 0.001
small change times: 0
num iteration  44
[[  8.46373873e-01   1.53626127e-01]
 [  2.47070542e-05   9.99975293e-01]]
[[ 0.85774149  0.14225851]
 [ 0.10050935  0.89949065]]
Pi: [ 0.87327785  0.12672215]
-87758.93793
rate: 0.840085136435 0.001
delta: 0.00509654766938 0.001
small change times: 0
num iteration  45
[[  8.46375000e-01   1.53625000e-01]
 [  2.38806158e-05   9.99976119e-01]]
[[ 0.85774023  0.14225977]
 [ 0.10051057  0.89948943]]
Pi: [ 0.87327778  0.12672222]
-87758.9336318
rate: 0.843353051525 0.001
delta: 0.00429818902921 0.001
small change times: 0
num iteration  46
[[  8.46376015e-01   1.53623985e-01]
 [  2.31318823e-05   9.99976868e-01]]
[[ 0.85773908  0.14226092]
 [ 0.10051169  0.89948831]]
Pi: [ 0.87327772  0.12672228]
-87758.9299936
rate: 0.846453548671 0.001
delta: 0.00363821735664 0.001
small change times: 0
num iteration  47
[[  8.46376931e-01   1.53623069e-01]
 [  2.24517000e-05   9.99977548e-01]]
[[ 0.85773804  0.14226196]
 [ 0.1005127   0.8994873 ]]
Pi: [ 0.87327767  0.12672233]
-87758.9269034
rate: 0.84939227165 0.001
delta: 0.00309027370531 0.001
small change times: 0
num iteration  48
[[  8.46377760e-01   1.53622240e-01]
 [  2.18322154e-05   9.99978168e-01]]
[[ 0.85773709  0.14226291]
 [ 0.10051363  0.89948637]]
Pi: [ 0.87327761  0.12672239]
-87758.9242699
rate: 0.852174719665 0.001
delta: 0.00263345312851 0.001
small change times: 0
num iteration  49
[[  8.46378514e-01   1.53621486e-01]
 [  2.12666619e-05   9.99978733e-01]]
[[ 0.85773623  0.14226377]
 [ 0.10051449  0.89948551]]
Pi: [ 0.87327757  0.12672243]
-87758.9220188
rate: 0.854807677808 0.001
delta: 0.0022510959534 0.001
small change times: 0
num iteration  50
[[  8.46379199e-01   1.53620801e-01]
 [  2.07491864e-05   9.99979251e-01]]
[[ 0.85773544  0.14226456]
 [ 0.10051527  0.89948473]]
Pi: [ 0.87327752  0.12672248]
-87758.9200889
rate: 0.857297331555 0.001
delta: 0.00192985855392 0.001
small change times: 0
num iteration  51
[[  8.46379825e-01   1.53620175e-01]
 [  2.02747058e-05   9.99979725e-01]]
[[ 0.85773472  0.14226528]
 [ 0.10051599  0.89948401]]
Pi: [ 0.87327748  0.12672252]
-87758.9184299
rate: 0.8596505535 0.001
delta: 0.00165900397405 0.001
small change times: 0
num iteration  52
[[  8.46380397e-01   1.53619603e-01]
 [  1.98387897e-05   9.99980161e-01]]
[[ 0.85773406  0.14226594]
 [ 0.10051666  0.89948334]]
Pi: [ 0.87327745  0.12672255]
-87758.9170001
rate: 0.861873937473 0.001
delta: 0.0014298522874 0.001
small change times: 0
num iteration  53
[[  8.46380922e-01   1.53619078e-01]
 [  1.94375624e-05   9.99980562e-01]]
[[ 0.85773345  0.14226655]
 [ 0.10051728  0.89948272]]
Pi: [ 0.87327741  0.12672259]
-87758.9157647
rate: 0.863974275418 0.001
delta: 0.00123535559396 0.001
small change times: 0
num iteration  54
[[  8.46381404e-01   1.53618596e-01]
 [  1.90676219e-05   9.99980932e-01]]
[[ 0.85773289  0.14226711]
 [ 0.10051784  0.89948216]]
Pi: [ 0.87327738  0.12672262]
-87758.914695
rate: 0.865957471871 0.001
delta: 0.00106976540701 0.001
small change times: 0
num iteration  55
[[  8.46381847e-01   1.53618153e-01]
 [  1.87259724e-05   9.99981274e-01]]
[[ 0.85773237  0.14226763]
 [ 0.10051837  0.89948163]]
Pi: [ 0.87327735  0.12672265]
-87758.9137666
rate: 0.867830615398 0.001
delta: 0.000928375171497 0.001
small change times: 1
num iteration  56
[[  8.46382255e-01   1.53617745e-01]
 [  1.84099669e-05   9.99981590e-01]]
[[ 0.85773189  0.14226811]
 [ 0.10051886  0.89948114]]
Pi: [ 0.87327732  0.12672268]
-87758.9129593
rate: 0.869598969589 0.001
delta: 0.000807314092526 0.001
small change times: 2
num iteration  57
[[  8.46382633e-01   1.53617367e-01]
 [  1.81172601e-05   9.99981883e-01]]
[[ 0.85773145  0.14226855]
 [ 0.10051931  0.89948069]]
Pi: [ 0.8732773  0.1267227]
-87758.9122559
rate: 0.871268394747 0.001
delta: 0.000703387253452 0.001
small change times: 3
num iteration  58
[[  8.46382981e-01   1.53617019e-01]
 [  1.78457674e-05   9.99982154e-01]]
[[ 0.85773104  0.14226896]
 [ 0.10051974  0.89948026]]
Pi: [ 0.87327728  0.12672272]
-87758.9116419
rate: 0.872845402401 0.001
delta: 0.000613948330283 0.001
small change times: 4
num iteration  59
[[  8.46383304e-01   1.53616696e-01]
 [  1.75936312e-05   9.99982406e-01]]
[[ 0.85773065  0.14226935]
 [ 0.10052013  0.89947987]]
Pi: [ 0.87327725  0.12672275]
-87758.9111051
rate: 0.874333707954 0.001
delta: 0.000536795720109 0.001
small change times: 5
num iteration  60
[[  8.46383603e-01   1.53616397e-01]
 [  1.73591913e-05   9.99982641e-01]]
[[ 0.8577303  0.1422697]
 [ 0.1005205  0.8994795]]
Pi: [ 0.87327723  0.12672277]
-87758.9106351
rate: 0.875739234648 0.001
delta: 0.000470093073091 0.001
small change times: 6
==================================================
只有EM步骤迭代
HMM content: N = 2 ,M = 2
hmm.A  [ 0.8463836  0.1536164]  hmm.B  [ 0.8577303  0.1422697]
       [  1.73591913e-05   9.99982641e-01]         [ 0.1005205  0.8994795]
hmm.pi [ 0.87327723  0.12672277]
finalprob: -87758.9106351
iteration num: 61
totaltime: 61
==================================================
