python my HMM
['sparkpybkt_hdfs_beta3.py', '1', '5']
BaumWelch
user_num  10000
column_num 20
beta3
num iteration  0
[[ 0.8596923   0.1403077 ]
 [ 0.11595643  0.88404357]]
[[ 0.49893299  0.50106701]
 [ 0.12496484  0.87503516]]
Pi: [ 0.63990831  0.36009169]
-122161.978719
num iteration  0
[[ 0.84435187  0.15564813]
 [ 0.0640433   0.9359567 ]]
[[ 0.62990898  0.37009102]
 [ 0.07840792  0.92159208]]
Pi: [ 0.82488035  0.17511965]
-107537.156704
rate: 1.46248220149e+73 0.001
delta: 14624.8220149 0.001
small change times: 0
num iteration  1
[[ 0.83509122  0.16490878]
 [ 0.03485656  0.96514344]]
[[ 0.73917636  0.26082364]
 [ 0.06779738  0.93220262]]
Pi: [ 0.89878361  0.10121639]
-96128.1878681
rate: 0.780109927117 0.001
delta: 11408.9688361 0.001
small change times: 0
num iteration  2
[[ 0.83114922  0.16885078]
 [ 0.0211171   0.9788829 ]]
[[ 0.80008861  0.19991139]
 [ 0.07367276  0.92632724]]
Pi: [ 0.91349729  0.08650271]
-91155.0488173
rate: 0.435897329748 0.001
delta: 4973.13905084 0.001
small change times: 0
num iteration  3
[[ 0.83177548  0.16822452]
 [ 0.01332617  0.98667383]]
[[ 0.83075311  0.16924689]
 [ 0.08218214  0.91781786]]
Pi: [ 0.90854449  0.09145551]
-89369.116732
rate: 0.359115654512 0.001
delta: 1785.93208522 0.001
small change times: 0
num iteration  4
[[ 0.83465233  0.16534767]
 [ 0.00852402  0.99147598]]
[[ 0.84595324  0.15404676]
 [ 0.08874461  0.91125539]]
Pi: [ 0.8983177  0.1016823]
-88577.757449
rate: 0.44310715371 0.001
delta: 791.359283001 0.001
small change times: 0
num iteration  5
[[ 0.83777179  0.16222821]
 [ 0.00555181  0.99444819]]
[[ 0.85329718  0.14670282]
 [ 0.09302689  0.90697311]]
Pi: [ 0.88899836  0.11100164]
-88194.0893537
rate: 0.48482162722 0.001
delta: 383.6680953 0.001
small change times: 0
num iteration  6
[[ 0.84029002  0.15970998]
 [ 0.00370559  0.99629441]]
[[ 0.85666617  0.14333383]
 [ 0.09568122  0.90431878]]
Pi: [ 0.88245602  0.11754398]
-88001.8452946
rate: 0.501068661817 0.001
delta: 192.244059094 0.001
small change times: 0
num iteration  7
[[ 0.84210137  0.15789863]
 [ 0.00254098  0.99745902]]
[[ 0.85808446  0.14191554]
 [ 0.09731306  0.90268694]]
Pi: [ 0.87843052  0.12156948]
-87901.7223122
rate: 0.520811841693 0.001
delta: 100.122982471 0.001
small change times: 0
num iteration  8
[[ 0.84334851  0.15665149]
 [ 0.00178972  0.99821028]]
[[ 0.85858948  0.14141052]
 [ 0.09832777  0.90167223]]
Pi: [ 0.8761213  0.1238787]
-87846.8449766
rate: 0.548099290011 0.001
delta: 54.8773356063 0.001
small change times: 0
num iteration  9
[[ 0.84419852  0.15580148]
 [ 0.00129297  0.99870703]]
[[ 0.85869171  0.14130829]
 [ 0.09897302  0.90102698]]
Pi: [ 0.87484316  0.12515684]
-87815.1762961
rate: 0.577081232924 0.001
delta: 31.6686804913 0.001
small change times: 0
num iteration  10
[[  8.44781660e-01   1.55218340e-01]
 [  9.56263491e-04   9.99043737e-01]]
[[ 0.85863166  0.14136834]
 [ 0.09939517  0.90060483]]
Pi: [ 0.87414642  0.12585358]
-87796.0720866
rate: 0.603252461178 0.001
delta: 19.1042094486 0.001
small change times: 0
num iteration  11
[[  8.45187609e-01   1.54812391e-01]
 [  7.22547289e-04   9.99277453e-01]]
[[ 0.85851778  0.14148222]
 [ 0.09967988  0.90032012]]
Pi: [ 0.87376741  0.12623259]
-87784.1169481
rate: 0.625785568834 0.001
delta: 11.9551385769 0.001
small change times: 0
num iteration  12
[[  8.45475355e-01   1.54524645e-01]
 [  5.56674526e-04   9.99443325e-01]]
[[ 0.85839632  0.14160368]
 [ 0.09987767  0.90012233]]
Pi: [ 0.8735598  0.1264402]
-87776.4010401
rate: 0.645405146378 0.001
delta: 7.71590796323 0.001
small change times: 0
num iteration  13
[[  8.45683168e-01   1.54316832e-01]
 [  4.36525217e-04   9.99563475e-01]]
[[ 0.85828516  0.14171484]
 [ 0.10001887  0.89998113]]
Pi: [ 0.87344452  0.12655548]
-87771.2866352
rate: 0.662839020306 0.001
delta: 5.11440487512 0.001
small change times: 0
num iteration  14
[[  8.45835953e-01   1.54164047e-01]
 [  3.47869961e-04   9.99652130e-01]]
[[ 0.85818974  0.14181026]
 [ 0.10012216  0.89987784]]
Pi: [ 0.87337934  0.12662066]
-87767.8166639
rate: 0.678470211171 0.001
delta: 3.46997135563 0.001
small change times: 0
num iteration  15
[[  8.45950126e-01   1.54049874e-01]
 [  2.81354089e-04   9.99718646e-01]]
[[ 0.85811029  0.14188971]
 [ 0.10019936  0.89980064]]
Pi: [ 0.87334166  0.12665834]
-87765.4138566
rate: 0.692457363221 0.001
delta: 2.40280721537 0.001
small change times: 0
num iteration  16
[[  8.46036694e-01   1.53963306e-01]
 [  2.30696202e-04   9.99769304e-01]]
[[ 0.85804513  0.14195487]
 [ 0.10025813  0.89974187]]
Pi: [ 0.87331934  0.12668066]
-87763.7201425
rate: 0.704889730636 0.001
delta: 1.69371413082 0.001
small change times: 0
num iteration  17
[[  8.46103184e-01   1.53896816e-01]
 [  1.91592485e-04   9.99808408e-01]]
[[ 0.85799203  0.14200797]
 [ 0.10030364  0.89969636]]
Pi: [ 0.87330577  0.12669423]
-87762.5076618
rate: 0.715870926208 0.001
delta: 1.21248070356 0.001
small change times: 0
num iteration  18
[[  8.46154843e-01   1.53845157e-01]
 [  1.61037702e-04   9.99838962e-01]]
[[ 0.85794885  0.14205115]
 [ 0.10033938  0.89966062]]
Pi: [ 0.87329728  0.12670272]
-87761.627954
rate: 0.725543779219 0.001
delta: 0.879707831889 0.001
small change times: 0
num iteration  19
[[  8.46195394e-01   1.53804606e-01]
 [  1.36896301e-04   9.99863104e-01]]
[[ 0.85791371  0.14208629]
 [ 0.10036783  0.89963217]]
Pi: [ 0.87329183  0.12670817]
-87760.9821735
rate: 0.734085183001 0.001
delta: 0.64578048476 0.001
small change times: 0
num iteration  20
[[  8.46227527e-01   1.53772473e-01]
 [  1.17626261e-04   9.99882374e-01]]
[[ 0.85788503  0.14211497]
 [ 0.10039074  0.89960926]]
Pi: [ 0.87328821  0.12671179]
-87760.5032045
rate: 0.741690130219 0.001
delta: 0.478969011834 0.001
small change times: 0
num iteration  21
[[  8.46253211e-01   1.53746789e-01]
 [  1.02097915e-04   9.99897902e-01]]
[[ 0.85786155  0.14213845]
 [ 0.10040939  0.89959061]]
Pi: [ 0.87328575  0.12671425]
-87760.1446702
rate: 0.748554294803 0.001
delta: 0.358534310886 0.001
small change times: 0
num iteration  22
[[  8.46273909e-01   1.53726091e-01]
 [  8.94728640e-05   9.99910527e-01]]
[[ 0.85784222  0.14215778]
 [ 0.10042473  0.89957527]]
Pi: [ 0.87328401  0.12671599]
-87759.8740273
rate: 0.754859119884 0.001
delta: 0.270642894364 0.001
small change times: 0
num iteration  23
[[  8.46290717e-01   1.53709283e-01]
 [  7.91215978e-05   9.99920878e-01]]
[[ 0.85782624  0.14217376]
 [ 0.10043746  0.89956254]]
Pi: [ 0.87328276  0.12671724]
-87759.6681327
rate: 0.760760991856 0.001
delta: 0.205894556755 0.001
small change times: 0
num iteration  24
[[  8.46304468e-01   1.53695532e-01]
 [  7.05665073e-05   9.99929433e-01]]
[[ 0.85781295  0.14218705]
 [ 0.10044811  0.89955189]]
Pi: [ 0.87328183  0.12671817]
-87759.5103382
rate: 0.766385092552 0.001
delta: 0.157794518935 0.001
small change times: 0
num iteration  25
[[  8.46315799e-01   1.53684201e-01]
 [  6.34418134e-05   9.99936558e-01]]
[[ 0.85780185  0.14219815]
 [ 0.1004571   0.8995429 ]]
Pi: [ 0.87328112  0.12671888]
-87759.3885487
rate: 0.771823677618 0.001
delta: 0.121789545912 0.001
small change times: 0
num iteration  26
[[  8.46325201e-01   1.53674799e-01]
 [  5.74649824e-05   9.99942535e-01]]
[[ 0.85779251  0.14220749]
 [ 0.10046474  0.89953526]]
Pi: [ 0.87328056  0.12671944]
-87759.2939014
rate: 0.777138064764 0.001
delta: 0.0946472920186 0.001
small change times: 0
num iteration  27
[[  8.46333056e-01   1.53666944e-01]
 [  5.24160577e-05   9.99947584e-01]]
[[ 0.85778461  0.14221539]
 [ 0.10047127  0.89952873]]
Pi: [ 0.87328011  0.12671989]
-87759.2198528
rate: 0.78236308848 0.001
delta: 0.0740485476999 0.001
small change times: 0
num iteration  28
[[  8.46339661e-01   1.53660339e-01]
 [  4.81225365e-05   9.99951877e-01]]
[[ 0.85777789  0.14222211]
 [ 0.1004769   0.8995231 ]]
Pi: [ 0.87327975  0.12672025]
-87759.1615386
rate: 0.787512840001 0.001
delta: 0.0583141820971 0.001
small change times: 0
num iteration  29
[[  8.46345251e-01   1.53654749e-01]
 [  4.44481879e-05   9.99955552e-01]]
[[ 0.85777214  0.14222786]
 [ 0.10048178  0.89951822]]
Pi: [ 0.87327944  0.12672056]
-87759.1153196
rate: 0.792586646335 0.001
delta: 0.0462190420221 0.001
small change times: 0
num iteration  30
[[  8.46350012e-01   1.53649988e-01]
 [  4.12847060e-05   9.99958715e-01]]
[[ 0.8577672   0.1422328 ]
 [ 0.10048603  0.89951397]]
Pi: [ 0.87327918  0.12672082]
-87759.0784565
rate: 0.797574396259 0.001
delta: 0.0368631245365 0.001
small change times: 0
num iteration  31
[[  8.46354089e-01   1.53645911e-01]
 [  3.85454303e-05   9.99961455e-01]]
[[ 0.85776292  0.14223708]
 [ 0.10048976  0.89951024]]
Pi: [ 0.87327896  0.12672104]
-87759.0488752
rate: 0.802461028264 0.001
delta: 0.0295812208205 0.001
small change times: 0
num iteration  32
[[  8.46357602e-01   1.53642398e-01]
 [  3.61605846e-05   9.99963839e-01]]
[[ 0.85775921  0.14224079]
 [ 0.10049303  0.89950697]]
Pi: [ 0.87327877  0.12672123]
-87759.0249964
rate: 0.807229782913 0.001
delta: 0.0238788424613 0.001
small change times: 0
num iteration  33
[[  8.46360645e-01   1.53639355e-01]
 [  3.40736440e-05   9.99965926e-01]]
[[ 0.85775596  0.14224404]
 [ 0.10049593  0.89950407]]
Pi: [ 0.87327861  0.12672139]
-87759.00561
rate: 0.811864536975 0.001
delta: 0.0193863853783 0.001
small change times: 0
num iteration  34
[[  8.46363295e-01   1.53636705e-01]
 [  3.22385451e-05   9.99967761e-01]]
[[ 0.85775312  0.14224688]
 [ 0.1004985   0.8995015 ]]
Pi: [ 0.87327846  0.12672154]
-87758.9897839
rate: 0.816351169373 0.001
delta: 0.0158260983735 0.001
small change times: 0
num iteration  35
[[  8.46365615e-01   1.53634385e-01]
 [  3.06175315e-05   9.99969382e-01]]
[[ 0.8577506  0.1422494]
 [ 0.1005008  0.8994992]]
Pi: [ 0.87327833  0.12672167]
-87758.9767958
rate: 0.820678311088 0.001
delta: 0.0129881356843 0.001
small change times: 0
num iteration  36
[[  8.46367654e-01   1.53632346e-01]
 [  2.91794800e-05   9.99970821e-01]]
[[ 0.85774838  0.14225162]
 [ 0.10050285  0.89949715]]
Pi: [ 0.87327822  0.12672178]
-87758.9660827
rate: 0.8248374897 0.001
delta: 0.0107131012337 0.001
small change times: 0
num iteration  37
[[  8.46369454e-01   1.53630546e-01]
 [  2.78985937e-05   9.99972101e-01]]
[[ 0.8577464   0.1422536 ]
 [ 0.10050469  0.89949531]]
Pi: [ 0.87327811  0.12672189]
-87758.9572034
rate: 0.828823449271 0.001
delta: 0.00887926951691 0.001
small change times: 0
num iteration  38
[[  8.46371052e-01   1.53628948e-01]
 [  2.67533755e-05   9.99973247e-01]]
[[ 0.85774464  0.14225536]
 [ 0.10050635  0.89949365]]
Pi: [ 0.87327802  0.12672198]
-87758.9498102
rate: 0.832633183042 0.001
delta: 0.00739317444095 0.001
small change times: 0
num iteration  39
[[  8.46372474e-01   1.53627526e-01]
 [  2.57258181e-05   9.99974274e-01]]
[[ 0.85774306  0.14225694]
 [ 0.10050785  0.89949215]]
Pi: [ 0.87327794  0.12672206]
-87758.9436276
rate: 0.836266374576 0.001
delta: 0.00618266318634 0.001
small change times: 0
num iteration  40
[[  8.46373745e-01   1.53626255e-01]
 [  2.48007616e-05   9.99975199e-01]]
[[ 0.85774164  0.14225836]
 [ 0.10050921  0.89949079]]
Pi: [ 0.87327786  0.12672214]
-87758.9384358
rate: 0.83972446035 0.001
delta: 0.00519173350767 0.001
small change times: 0
num iteration  41
[[  8.46374885e-01   1.53625115e-01]
 [  2.39653808e-05   9.99976035e-01]]
[[ 0.85774036  0.14225964]
 [ 0.10051045  0.89948955]]
Pi: [ 0.87327779  0.12672221]
-87758.9340592
rate: 0.843010513598 0.001
delta: 0.00437668593077 0.001
small change times: 0
num iteration  42
[[  8.46375911e-01   1.53624089e-01]
 [  2.32087746e-05   9.99976791e-01]]
[[ 0.8577392   0.1422608 ]
 [ 0.10051157  0.89948843]]
Pi: [ 0.87327773  0.12672227]
-87758.9303559
rate: 0.846128776628 0.001
delta: 0.00370323991228 0.001
small change times: 0
num iteration  43
[[  8.46376837e-01   1.53623163e-01]
 [  2.25216352e-05   9.99977478e-01]]
[[ 0.85773815  0.14226185]
 [ 0.1005126   0.8994874 ]]
Pi: [ 0.87327767  0.12672233]
-87758.9272115
rate: 0.849084602564 0.001
delta: 0.00314436398912 0.001
small change times: 0
num iteration  44
[[  8.46377675e-01   1.53622325e-01]
 [  2.18959805e-05   9.99978104e-01]]
[[ 0.85773719  0.14226281]
 [ 0.10051354  0.89948646]]
Pi: [ 0.87327762  0.12672238]
-87758.9245329
rate: 0.851883487565 0.001
delta: 0.00267863176123 0.001
small change times: 0
num iteration  45
[[  8.46378436e-01   1.53621564e-01]
 [  2.13249363e-05   9.99978675e-01]]
[[ 0.85773632  0.14226368]
 [ 0.1005144   0.8994856 ]]
Pi: [ 0.87327757  0.12672243]
-87758.9222439
rate: 0.854532194476 0.001
delta: 0.00228897707711 0.001
small change times: 0
num iteration  46
[[  8.46379129e-01   1.53620871e-01]
 [  2.08025589e-05   9.99979197e-01]]
[[ 0.85773552  0.14226448]
 [ 0.10051519  0.89948481]]
Pi: [ 0.87327753  0.12672247]
-87758.9202822
rate: 0.857036891293 0.001
delta: 0.00196173779841 0.001
small change times: 0
num iteration  47
[[  8.46379761e-01   1.53620239e-01]
 [  2.03236886e-05   9.99979676e-01]]
[[ 0.85773479  0.14226521]
 [ 0.10051592  0.89948408]]
Pi: [ 0.87327749  0.12672251]
-87758.9185963
rate: 0.859404406637 0.001
delta: 0.00168592610862 0.001
small change times: 0
num iteration  48
[[  8.46380338e-01   1.53619662e-01]
 [  1.98838300e-05   9.99980116e-01]]
[[ 0.85773413  0.14226587]
 [ 0.10051659  0.89948341]]
Pi: [ 0.87327745  0.12672255]
-87758.9171436
rate: 0.861641507265 0.001
delta: 0.00145266391337 0.001
small change times: 0
num iteration  49
[[  8.46380868e-01   1.53619132e-01]
 [  1.94790518e-05   9.99980521e-01]]
[[ 0.85773351  0.14226649]
 [ 0.10051721  0.89948279]]
Pi: [ 0.87327742  0.12672258]
-87758.9158889
rate: 0.863754507029 0.001
delta: 0.00125474500237 0.001
small change times: 0
num iteration  50
[[  8.46381354e-01   1.53618646e-01]
 [  1.91059050e-05   9.99980894e-01]]
[[ 0.85773294  0.14226706]
 [ 0.10051779  0.89948221]]
Pi: [ 0.87327738  0.12672262]
-87758.9148026
rate: 0.865750343692 0.001
delta: 0.00108629591705 0.001
small change times: 0
num iteration  51
[[  8.46381801e-01   1.53618199e-01]
 [  1.87613529e-05   9.99981239e-01]]
[[ 0.85773242  0.14226758]
 [ 0.10051832  0.89948168]]
Pi: [ 0.87327735  0.12672265]
-87758.9138601
rate: 0.867634582312 0.001
delta: 0.000942507904256 0.001
small change times: 1
num iteration  52
[[  8.46382213e-01   1.53617787e-01]
 [  1.84427135e-05   9.99981557e-01]]
[[ 0.85773194  0.14226806]
 [ 0.10051881  0.89948119]]
Pi: [ 0.87327733  0.12672267]
-87758.9130406
rate: 0.869413983463 0.001
delta: 0.000819429551484 0.001
small change times: 2
num iteration  53
[[  8.46382593e-01   1.53617407e-01]
 [  1.81476113e-05   9.99981852e-01]]
[[ 0.85773149  0.14226851]
 [ 0.10051927  0.89948073]]
Pi: [ 0.8732773  0.1267227]
-87758.9123268
rate: 0.871094215192 0.001
delta: 0.000713800342055 0.001
small change times: 3
num iteration  54
[[  8.46382945e-01   1.53617055e-01]
 [  1.78739355e-05   9.99982126e-01]]
[[ 0.85773108  0.14226892]
 [ 0.10051969  0.89948031]]
Pi: [ 0.87327728  0.12672272]
-87758.9117039
rate: 0.872680282507 0.001
delta: 0.000622919484158 0.001
small change times: 4
num iteration  55
[[  8.46383271e-01   1.53616729e-01]
 [  1.76198055e-05   9.99982380e-01]]
[[ 0.85773069  0.14226931]
 [ 0.10052009  0.89947991]]
Pi: [ 0.87327726  0.12672274]
-87758.9111594
rate: 0.874178017129 0.001
delta: 0.000544542519492 0.001
small change times: 5
num iteration  56
[[  8.46383572e-01   1.53616428e-01]
 [  1.73835411e-05   9.99982616e-01]]
[[ 0.85773034  0.14226966]
 [ 0.10052046  0.89947954]]
Pi: [ 0.87327724  0.12672276]
-87758.9106826
rate: 0.875592363014 0.001
delta: 0.000476797271403 0.001
small change times: 6
==================================================
只有EM步骤迭代
HMM content: N = 2 ,M = 2
hmm.A  [ 0.84638357  0.15361643]  hmm.B  [ 0.85773034  0.14226966]
       [  1.73835411e-05   9.99982616e-01]         [ 0.10052046  0.89947954]
hmm.pi [ 0.87327724  0.12672276]
finalprob: -87758.9106826
iteration num: 57
totaltime: 60
==================================================
