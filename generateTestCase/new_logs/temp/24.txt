python my HMM
['sparkpybkt_hdfs_beta3.py', '2', '4']
BaumWelch
user_num  10000
column_num 20
beta3
num iteration  0
[[ 0.76494765  0.23505235]
 [ 0.11201911  0.88798089]]
[[ 0.61652395  0.38347605]
 [ 0.12210491  0.87789509]]
Pi: [ 0.6663249  0.3336751]
-119111.786758
num iteration  0
[[ 0.79008316  0.20991684]
 [ 0.06358901  0.93641099]]
[[ 0.7309568   0.2690432 ]
 [ 0.07974744  0.92025256]]
Pi: [ 0.84135123  0.15864877]
-102481.021638
rate: 1.66307651199e+73 0.001
delta: 16630.7651199 0.001
small change times: 0
num iteration  1
[[ 0.80799874  0.19200126]
 [ 0.03608202  0.96391798]]
[[ 0.80042699  0.19957301]
 [ 0.07073682  0.92926318]]
Pi: [ 0.89680875  0.10319125]
-93276.421984
rate: 0.553468201136 0.001
delta: 9204.59965441 0.001
small change times: 0
num iteration  2
[[ 0.8182957   0.1817043 ]
 [ 0.02230788  0.97769212]]
[[ 0.8319459   0.1680541 ]
 [ 0.07628269  0.92371731]]
Pi: [ 0.90454101  0.09545899]
-90218.3530667
rate: 0.332232691493 0.001
delta: 3058.0689173 0.001
small change times: 0
num iteration  3
[[ 0.82603785  0.17396215]
 [ 0.0141712   0.9858288 ]]
[[ 0.84660392  0.15339608]
 [ 0.0838029   0.9161971 ]]
Pi: [ 0.89894416  0.10105584]
-89117.2683206
rate: 0.360058839706 0.001
delta: 1101.0847461 0.001
small change times: 0
num iteration  4
[[ 0.83216715  0.16783285]
 [ 0.00907768  0.99092232]]
[[ 0.85374483  0.14625517]
 [ 0.08957794  0.91042206]]
Pi: [ 0.89102694  0.10897306]
-88525.6132594
rate: 0.537338350479 0.001
delta: 591.655061208 0.001
small change times: 0
num iteration  5
[[ 0.83666213  0.16333787]
 [ 0.00590326  0.99409674]]
[[ 0.85710171  0.14289829]
 [ 0.0934013   0.9065987 ]]
Pi: [ 0.88444615  0.11555385]
-88193.6120876
rate: 0.561139747767 0.001
delta: 332.001171812 0.001
small change times: 0
num iteration  6
[[ 0.83975332  0.16024668]
 [ 0.00392765  0.99607235]]
[[ 0.85851707  0.14148293]
 [ 0.095821    0.904179  ]]
Pi: [ 0.87993042  0.12006958]
-88010.8015146
rate: 0.550632312368 0.001
delta: 182.810572943 0.001
small change times: 0
num iteration  7
[[ 0.84181447  0.15818553]
 [ 0.00268307  0.99731693]]
[[ 0.85898785  0.14101215]
 [ 0.09734414  0.90265586]]
Pi: [ 0.87712661  0.12287339]
-87909.6771715
rate: 0.55316463098 0.001
delta: 101.124343121 0.001
small change times: 0
num iteration  8
[[ 0.84317989  0.15682011]
 [ 0.00188259  0.99811741]]
[[ 0.85903641  0.14096359]
 [ 0.09831467  0.90168533]]
Pi: [ 0.87547876  0.12452124]
-87852.3247216
rate: 0.567147811912 0.001
delta: 57.3524499324 0.001
small change times: 0
num iteration  9
[[ 0.84409155  0.15590845]
 [ 0.00135514  0.99864486]]
[[ 0.8589188   0.1410812 ]
 [ 0.09894609  0.90105391]]
Pi: [ 0.87453716  0.12546284]
-87818.7039626
rate: 0.586213126731 0.001
delta: 33.6207590006 0.001
small change times: 0
num iteration  10
[[  8.44709883e-01   1.55290117e-01]
 [  9.98898328e-04   9.99001102e-01]]
[[ 0.85875202  0.14124798]
 [ 0.09936719  0.90063281]]
Pi: [ 0.874005  0.125995]
-87798.320479
rate: 0.606276721256 0.001
delta: 20.383483533 0.001
small change times: 0
num iteration  11
[[  8.45137503e-01   1.54862497e-01]
 [  7.52461085e-04   9.99247539e-01]]
[[ 0.85858538  0.14141462]
 [ 0.0996554   0.9003446 ]]
Pi: [ 0.87370412  0.12629588]
-87785.5670387
rate: 0.625675212051 0.001
delta: 12.7534403819 0.001
small change times: 0
num iteration  12
[[  8.45439370e-01   1.54560630e-01]
 [  5.78113850e-04   9.99421886e-01]]
[[ 0.858437    0.141563  ]
 [ 0.09985769  0.90014231]]
Pi: [ 0.87353265  0.12646735]
-87777.354766
rate: 0.643926065441 0.001
delta: 8.21227268592 0.001
small change times: 0
num iteration  13
[[  8.45656768e-01   1.54343232e-01]
 [  4.52192224e-04   9.99547808e-01]]
[[ 0.85831147  0.14168853]
 [ 0.10000306  0.89999694]]
Pi: [ 0.87343362  0.12656638]
-87771.9274054
rate: 0.660884112468 0.001
delta: 5.42736054538 0.001
small change times: 0
num iteration  14
[[  8.45816256e-01   1.54183744e-01]
 [  3.59521726e-04   9.99640478e-01]]
[[ 0.8582079   0.1417921 ]
 [ 0.10010979  0.89989021]]
Pi: [ 0.87337548  0.12662452]
-87768.2560634
rate: 0.676450731384 0.001
delta: 3.67134201041 0.001
small change times: 0
num iteration  15
[[  8.45935222e-01   1.54064778e-01]
 [  2.90157783e-04   9.99709842e-01]]
[[ 0.8581235   0.1418765 ]
 [ 0.10018969  0.89981031]]
Pi: [ 0.8733407  0.1266593]
-87765.7208214
rate: 0.690549116684 0.001
delta: 2.53524198233 0.001
small change times: 0
num iteration  16
[[  8.46025278e-01   1.53974722e-01]
 [  2.37443259e-04   9.99762557e-01]]
[[ 0.85805511  0.14194489]
 [ 0.10025055  0.89974945]]
Pi: [ 0.87331946  0.12668054]
-87763.9381459
rate: 0.70315795986 0.001
delta: 1.78267558005 0.001
small change times: 0
num iteration  17
[[  8.46094344e-01   1.53905656e-01]
 [  1.96830129e-04   9.99803170e-01]]
[[ 0.85799978  0.14200022]
 [ 0.10029765  0.89970235]]
Pi: [ 0.87330622  0.12669378]
-87762.6647295
rate: 0.714328712592 0.001
delta: 1.27341635207 0.001
small change times: 0
num iteration  18
[[  8.46147929e-01   1.53852071e-01]
 [  1.65151250e-04   9.99834849e-01]]
[[ 0.85795498  0.14204502]
 [ 0.10033461  0.89966539]]
Pi: [ 0.87329776  0.12670224]
-87761.7425478
rate: 0.724179247778 0.001
delta: 0.922181695947 0.001
small change times: 0
num iteration  19
[[  8.46189937e-01   1.53810063e-01]
 [  1.40161648e-04   9.99859838e-01]]
[[ 0.85791862  0.14208138]
 [ 0.10036399  0.89963601]]
Pi: [ 0.87329224  0.12670776]
-87761.066704
rate: 0.732874858422 0.001
delta: 0.675843779856 0.001
small change times: 0
num iteration  20
[[  8.46223182e-01   1.53776818e-01]
 [  1.20243989e-04   9.99879756e-01]]
[[ 0.85788901  0.14211099]
 [ 0.10038763  0.89961237]]
Pi: [ 0.87328854  0.12671146]
-87760.56617
rate: 0.740606130168 0.001
delta: 0.500534046398 0.001
small change times: 0
num iteration  21
[[  8.46249724e-01   1.53750276e-01]
 [  1.04215869e-04   9.99895784e-01]]
[[ 0.85786479  0.14213521]
 [ 0.10040684  0.89959316]]
Pi: [ 0.873286  0.126714]
-87760.1919864
rate: 0.747568599157 0.001
delta: 0.374183535896 0.001
small change times: 0
num iteration  22
[[  8.46271088e-01   1.53728912e-01]
 [  9.12013685e-05   9.99908799e-01]]
[[ 0.85784489  0.14215511]
 [ 0.10042262  0.89957738]]
Pi: [ 0.87328421  0.12671579]
-87759.9098722
rate: 0.753946227854 0.001
delta: 0.282114265414 0.001
small change times: 0
num iteration  23
[[  8.46288418e-01   1.53711582e-01]
 [  8.05438938e-05   9.99919456e-01]]
[[ 0.85782845  0.14217155]
 [ 0.1004357   0.8995643 ]]
Pi: [ 0.87328291  0.12671709]
-87759.6954937
rate: 0.759899509213 0.001
delta: 0.21437849183 0.001
small change times: 0
num iteration  24
[[  8.46302581e-01   1.53697419e-01]
 [  7.17460252e-05   9.99928254e-01]]
[[ 0.85781479  0.14218521]
 [ 0.10044663  0.89955337]]
Pi: [ 0.87328195  0.12671805]
-87759.5313744
rate: 0.765558440074 0.001
delta: 0.164119263791 0.001
small change times: 0
num iteration  25
[[  8.46314239e-01   1.53685761e-01]
 [  6.44273236e-05   9.99935573e-01]]
[[ 0.85780339  0.14219661]
 [ 0.10045585  0.89954415]]
Pi: [ 0.87328121  0.12671879]
-87759.4048352
rate: 0.771020130799 0.001
delta: 0.126539256235 0.001
small change times: 0
num iteration  26
[[  8.46323903e-01   1.53676097e-01]
 [  5.82942920e-05   9.99941706e-01]]
[[ 0.8577938   0.1422062 ]
 [ 0.10046367  0.89953633]]
Pi: [ 0.87328063  0.12671937]
-87759.3065964
rate: 0.776350277307 0.001
delta: 0.0982387866679 0.001
small change times: 0
num iteration  27
[[  8.46331968e-01   1.53668032e-01]
 [  5.31186986e-05   9.99946881e-01]]
[[ 0.85778571  0.14221429]
 [ 0.10047036  0.89952964]]
Pi: [ 0.87328017  0.12671983]
-87759.2298142
rate: 0.781587317943 0.001
delta: 0.0767821897898 0.001
small change times: 0
num iteration  28
[[  8.46338744e-01   1.53661256e-01]
 [  4.87217427e-05   9.99951278e-01]]
[[ 0.85777883  0.14222117]
 [ 0.10047611  0.89952389]]
Pi: [ 0.8732798  0.1267202]
-87759.169406
rate: 0.786748068911 0.001
delta: 0.0604082395439 0.001
small change times: 0
num iteration  29
[[  8.46344473e-01   1.53655527e-01]
 [  4.49623629e-05   9.99955038e-01]]
[[ 0.85777295  0.14222705]
 [ 0.10048109  0.89951891]]
Pi: [ 0.87327948  0.12672052]
-87759.1215727
rate: 0.791833687381 0.001
delta: 0.0478332790663 0.001
small change times: 0
num iteration  30
[[  8.46349347e-01   1.53650653e-01]
 [  4.17285235e-05   9.99958271e-01]]
[[ 0.85776789  0.14223211]
 [ 0.10048543  0.89951457]]
Pi: [ 0.87327922  0.12672078]
-87759.0834574
rate: 0.796835177111 0.001
delta: 0.0381152393966 0.001
small change times: 0
num iteration  31
[[  8.46353518e-01   1.53646482e-01]
 [  3.89306642e-05   9.99961069e-01]]
[[ 0.85776353  0.14223647]
 [ 0.10048923  0.89951077]]
Pi: [ 0.87327899  0.12672101]
-87759.052899
rate: 0.801737970115 0.001
delta: 0.0305584346643 0.001
small change times: 0
num iteration  32
[[  8.46357109e-01   1.53642891e-01]
 [  3.64967407e-05   9.99963503e-01]]
[[ 0.85775973  0.14224027]
 [ 0.10049257  0.89950743]]
Pi: [ 0.8732788  0.1267212]
-87759.0282528
rate: 0.806525391126 0.001
delta: 0.0246461534698 0.001
small change times: 0
num iteration  33
[[  8.46360217e-01   1.53639783e-01]
 [  3.43684433e-05   9.99965632e-01]]
[[ 0.85775642  0.14224358]
 [ 0.10049552  0.89950448]]
Pi: [ 0.87327863  0.12672137]
-87759.0082604
rate: 0.811181137642 0.001
delta: 0.0199924948101 0.001
small change times: 0
num iteration  34
[[  8.46362922e-01   1.53637078e-01]
 [  3.24982959e-05   9.99967502e-01]]
[[ 0.85775352  0.14224648]
 [ 0.10049814  0.89950186]]
Pi: [ 0.87327848  0.12672152]
-87758.9919527
rate: 0.815690687662 0.001
delta: 0.0163076918398 0.001
small change times: 0
num iteration  35
[[  8.46365287e-01   1.53634713e-01]
 [  3.08474176e-05   9.99969153e-01]]
[[ 0.85775096  0.14224904]
 [ 0.10050047  0.89949953]]
Pi: [ 0.87327835  0.12672165]
-87758.9785797
rate: 0.820042238651 0.001
delta: 0.0133729961235 0.001
small change times: 0
num iteration  36
[[  8.46367365e-01   1.53632635e-01]
 [  2.93837849e-05   9.99970616e-01]]
[[ 0.8577487   0.1422513 ]
 [ 0.10050256  0.89949744]]
Pi: [ 0.87327823  0.12672177]
-87758.9675573
rate: 0.824227005913 0.001
delta: 0.011022384555 0.001
small change times: 0
num iteration  37
[[  8.46369199e-01   1.53630801e-01]
 [  2.80808764e-05   9.99971919e-01]]
[[ 0.85774668  0.14225332]
 [ 0.10050443  0.89949557]]
Pi: [ 0.87327813  0.12672187]
-87758.9584281
rate: 0.828239025983 0.001
delta: 0.00912916904781 0.001
small change times: 0
num iteration  38
[[  8.46370825e-01   1.53629175e-01]
 [  2.69166085e-05   9.99973083e-01]]
[[ 0.85774489  0.14225511]
 [ 0.10050611  0.89949389]]
Pi: [ 0.87327803  0.12672197]
-87758.950832
rate: 0.832075149168 0.001
delta: 0.00759615469724 0.001
small change times: 0
num iteration  39
[[  8.46372271e-01   1.53627729e-01]
 [  2.58724971e-05   9.99974128e-01]]
[[ 0.85774328  0.14225672]
 [ 0.10050764  0.89949236]]
Pi: [ 0.87327795  0.12672205]
-87758.9444836
rate: 0.835734713153 0.001
delta: 0.00634837016696 0.001
small change times: 0
num iteration  40
[[  8.46373564e-01   1.53626436e-01]
 [  2.49329922e-05   9.99975067e-01]]
[[ 0.85774184  0.14225816]
 [ 0.10050902  0.89949098]]
Pi: [ 0.87327787  0.12672213]
-87758.9391559
rate: 0.839218804299 0.001
delta: 0.00532767162076 0.001
small change times: 0
num iteration  41
[[  8.46374722e-01   1.53625278e-01]
 [  2.40849480e-05   9.99975915e-01]]
[[ 0.85774054  0.14225946]
 [ 0.10051027  0.89948973]]
Pi: [ 0.8732778  0.1267222]
-87758.9346672
rate: 0.842530271775 0.001
delta: 0.00448872461857 0.001
small change times: 0
num iteration  42
[[  8.46375764e-01   1.53624236e-01]
 [  2.33171986e-05   9.99976683e-01]]
[[ 0.85773936  0.14226064]
 [ 0.10051141  0.89948859]]
Pi: [ 0.87327774  0.12672226]
-87758.9308712
rate: 0.845673420199 0.001
delta: 0.00379599510052 0.001
small change times: 0
num iteration  43
[[  8.46376704e-01   1.53623296e-01]
 [  2.26202166e-05   9.99977380e-01]]
[[ 0.8577383   0.1422617 ]
 [ 0.10051245  0.89948755]]
Pi: [ 0.87327768  0.12672232]
-87758.9276497
rate: 0.848652955338 0.001
delta: 0.0032214824605 0.001
small change times: 0
num iteration  44
[[  8.46377555e-01   1.53622445e-01]
 [  2.19858367e-05   9.99978014e-01]]
[[ 0.85773733  0.14226267]
 [ 0.1005134   0.8994866 ]]
Pi: [ 0.87327763  0.12672237]
-87758.9249067
rate: 0.851475071964 0.001
delta: 0.00274301200989 0.001
small change times: 0
num iteration  45
[[  8.46378327e-01   1.53621673e-01]
 [  2.14070314e-05   9.99978593e-01]]
[[ 0.85773644  0.14226356]
 [ 0.10051428  0.89948572]]
Pi: [ 0.87327758  0.12672242]
-87758.9225638
rate: 0.854145715334 0.001
delta: 0.00234293195535 0.001
small change times: 0
num iteration  46
[[  8.46379029e-01   1.53620971e-01]
 [  2.08777280e-05   9.99979122e-01]]
[[ 0.85773564  0.14226436]
 [ 0.10051508  0.89948492]]
Pi: [ 0.87327753  0.12672247]
-87758.9205566
rate: 0.856671515251 0.001
delta: 0.00200712306832 0.001
small change times: 0
num iteration  47
[[  8.46379670e-01   1.53620330e-01]
 [  2.03926576e-05   9.99979607e-01]]
[[ 0.8577349   0.1422651 ]
 [ 0.10051581  0.89948419]]
Pi: [ 0.87327749  0.12672251]
-87758.9188324
rate: 0.859059146805 0.001
delta: 0.00172423743061 0.001
small change times: 0
num iteration  48
[[  8.46380255e-01   1.53619745e-01]
 [  1.99472326e-05   9.99980053e-01]]
[[ 0.85773422  0.14226578]
 [ 0.10051649  0.89948351]]
Pi: [ 0.87327746  0.12672254]
-87758.9173473
rate: 0.86131525764 0.001
delta: 0.00148511200678 0.001
small change times: 0
num iteration  49
[[  8.46380792e-01   1.53619208e-01]
 [  1.95374429e-05   9.99980463e-01]]
[[ 0.8577336   0.1422664 ]
 [ 0.10051712  0.89948288]]
Pi: [ 0.87327742  0.12672258]
-87758.916065
rate: 0.863446503747 0.001
delta: 0.00128231476992 0.001
small change times: 0
num iteration  50
[[  8.46381284e-01   1.53618716e-01]
 [  1.91597722e-05   9.99980840e-01]]
[[ 0.85773303  0.14226697]
 [ 0.1005177   0.8994823 ]]
Pi: [ 0.87327739  0.12672261]
-87758.9149552
rate: 0.865459123922 0.001
delta: 0.00110979101737 0.001
small change times: 0
num iteration  51
[[  8.46381737e-01   1.53618263e-01]
 [  1.88111260e-05   9.99981189e-01]]
[[ 0.8577325   0.1422675 ]
 [ 0.10051824  0.89948176]]
Pi: [ 0.87327736  0.12672264]
-87758.9139926
rate: 0.867360067936 0.001
delta: 0.000962588412222 0.001
small change times: 1
num iteration  52
[[  8.46382154e-01   1.53617846e-01]
 [  1.84887729e-05   9.99981511e-01]]
[[ 0.85773201  0.14226799]
 [ 0.10051874  0.89948126]]
Pi: [ 0.87327733  0.12672267]
-87758.913156
rate: 0.869154620602 0.001
delta: 0.00083663816622 0.001
small change times: 2
num iteration  53
[[  8.46382539e-01   1.53617461e-01]
 [  1.81902940e-05   9.99981810e-01]]
[[ 0.85773156  0.14226844]
 [ 0.1005192   0.8994808 ]]
Pi: [ 0.87327731  0.12672269]
-87758.9124274
rate: 0.870848964637 0.001
delta: 0.000728585480829 0.001
small change times: 3
num iteration  54
[[  8.46382894e-01   1.53617106e-01]
 [  1.79135415e-05   9.99982086e-01]]
[[ 0.85773114  0.14226886]
 [ 0.10051963  0.89948037]]
Pi: [ 0.87327728  0.12672272]
-87758.9117917
rate: 0.872449282139 0.001
delta: 0.000635653879726 0.001
small change times: 4
num iteration  55
[[  8.46383224e-01   1.53616776e-01]
 [  1.76566023e-05   9.99982343e-01]]
[[ 0.85773075  0.14226925]
 [ 0.10052003  0.89947997]]
Pi: [ 0.87327726  0.12672274]
-87758.9112362
rate: 0.873959389313 0.001
delta: 0.00055553567654 0.001
small change times: 5
num iteration  56
[[  8.46383529e-01   1.53616471e-01]
 [  1.74177682e-05   9.99982582e-01]]
[[ 0.85773039  0.14226961]
 [ 0.1005204   0.8994796 ]]
Pi: [ 0.87327724  0.12672276]
-87758.9107499
rate: 0.875386684781 0.001
delta: 0.000486308534164 0.001
small change times: 6
==================================================
只有EM步骤迭代
HMM content: N = 2 ,M = 2
hmm.A  [ 0.84638353  0.15361647]  hmm.B  [ 0.85773039  0.14226961]
       [  1.74177682e-05   9.99982582e-01]         [ 0.1005204  0.8994796]
hmm.pi [ 0.87327724  0.12672276]
finalprob: -87758.9107499
iteration num: 57
totaltime: 60
==================================================
